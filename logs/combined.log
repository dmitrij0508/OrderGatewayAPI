{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-08 17:40:29"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 00:05:52"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:23:31"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:28:24"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:28:24"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:28:24"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:28:24"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:28:24"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:32:33"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:32:33"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:32:53"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:32:53"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:32:53"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:32:53"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:32:53"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:39:34","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:40:46","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Code/1.104.3 Chrome/138.0.7204.235 Electron/37.3.1 Safari/537.36"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:48:11","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:58:40","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:59:00","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:59:00"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:59:00"}
{"__augmented":true,"code":"SQLITE_ERROR","errno":1,"level":"error","message":"Failed to get menu: SQLITE_ERROR: unrecognized token: \":\"","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: unrecognized token: \":\"\n--> in Database#all('\\n' +\n  '        SELECT \\n' +\n  '          m.*,\\n' +\n  '          COALESCE(\\n' +\n  '            json_agg(\\n' +\n  '              json_build_object(\\n' +\n  \"                'id', mi.id,\\n\" +\n  \"                'name', mi.name,\\n\" +\n  \"                'price', mi.price,\\n\" +\n  \"                'available', mi.available\\n\" +\n  '              )\\n' +\n  '            ) FILTER (WHERE mi.id IS NOT NULL),\\n' +\n  \"            '[]'::json\\n\" +\n  '          ) as items\\n' +\n  '        FROM menus m\\n' +\n  '        LEFT JOIN menu_items mi ON m.id = mi.menu_id AND mi.available = true\\n' +\n  '       WHERE m.restaurant_id = $1\\n' +\n  '        GROUP BY m.id, m.restaurant_id, m.name, m.description, m.version, m.last_updated, m.created_at\\n' +\n  '        ORDER BY m.restaurant_id, m.name\\n' +\n  '      ', [ 'NYC-DELI-001' ], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at MenuService.getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\menuService.js:38:37)\n    at getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\menuController.js:15:38)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:84:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-10-09 08:59:00"}
{"body":{},"error":"SQLITE_ERROR: unrecognized token: \":\"","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"GET","path":"/api/v1/menu","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: unrecognized token: \":\"\n--> in Database#all('\\n' +\n  '        SELECT \\n' +\n  '          m.*,\\n' +\n  '          COALESCE(\\n' +\n  '            json_agg(\\n' +\n  '              json_build_object(\\n' +\n  \"                'id', mi.id,\\n\" +\n  \"                'name', mi.name,\\n\" +\n  \"                'price', mi.price,\\n\" +\n  \"                'available', mi.available\\n\" +\n  '              )\\n' +\n  '            ) FILTER (WHERE mi.id IS NOT NULL),\\n' +\n  \"            '[]'::json\\n\" +\n  '          ) as items\\n' +\n  '        FROM menus m\\n' +\n  '        LEFT JOIN menu_items mi ON m.id = mi.menu_id AND mi.available = true\\n' +\n  '       WHERE m.restaurant_id = $1\\n' +\n  '        GROUP BY m.id, m.restaurant_id, m.name, m.description, m.version, m.last_updated, m.created_at\\n' +\n  '        ORDER BY m.restaurant_id, m.name\\n' +\n  '      ', [ 'NYC-DELI-001' ], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at MenuService.getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\menuService.js:38:37)\n    at getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\menuController.js:15:38)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:84:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-10-09 08:59:00","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:59:22","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:59:22"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:59:42","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:59:42"}
{"client":"Mobile App","externalOrderId":"TEST-001","itemCount":1,"level":"info","message":"Creating order ORD-20241009-001","orderId":"ORD-20241009-001","orderType":"pickup","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 08:59:42","total":14.03}
{"__augmented":true,"code":"SQLITE_ERROR","errno":1,"level":"error","message":"Failed to create order: SQLITE_ERROR: no such function: NOW","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: no such function: NOW\n--> in Database#all('\\n' +\n  '        INSERT INTO orders (\\n' +\n  '          id, order_id, external_order_id, restaurant_id, idempotency_key,\\n' +\n  '          customer_name, customer_phone, customer_email,\\n' +\n  '          order_type, order_time, requested_time,\\n' +\n  '          subtotal, tax, tip, discount, delivery_fee, total,\\n' +\n  '          payment_method, payment_status, payment_transaction_id,\\n' +\n  '          notes, status, created_at, updated_at\\n' +\n  '        ) VALUES (\\n' +\n  '          $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, NOW(), NOW()\\n' +\n  '        ) RETURNING *\\n' +\n  '      ', [], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:71:14)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:29:40)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:56:21)","timestamp":"2025-10-09 08:59:42"}
{"body":{"customer":{"name":"Test Customer","phone":"555-0123"},"externalOrderId":"TEST-001","items":[{"itemId":"SANDWICH-001","name":"Turkey Club","quantity":1,"totalPrice":12.99,"unitPrice":12.99}],"orderId":"ORD-20241009-001","orderTime":"2025-10-09T08:59:42Z","orderType":"pickup","restaurantId":"NYC-DELI-001","totals":{"subtotal":12.99,"tax":1.04,"total":14.03}},"error":"SQLITE_ERROR: no such function: NOW","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: no such function: NOW\n--> in Database#all('\\n' +\n  '        INSERT INTO orders (\\n' +\n  '          id, order_id, external_order_id, restaurant_id, idempotency_key,\\n' +\n  '          customer_name, customer_phone, customer_email,\\n' +\n  '          order_type, order_time, requested_time,\\n' +\n  '          subtotal, tax, tip, discount, delivery_fee, total,\\n' +\n  '          payment_method, payment_status, payment_transaction_id,\\n' +\n  '          notes, status, created_at, updated_at\\n' +\n  '        ) VALUES (\\n' +\n  '          $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, NOW(), NOW()\\n' +\n  '        ) RETURNING *\\n' +\n  '      ', [], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:71:14)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:29:40)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:56:21)","timestamp":"2025-10-09 08:59:42","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:12:12","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:12:12"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:12:12"}
{"__augmented":true,"code":"SQLITE_ERROR","errno":1,"level":"error","message":"Failed to get menu: SQLITE_ERROR: unrecognized token: \":\"","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: unrecognized token: \":\"\n--> in Database#all('\\n' +\n  '        SELECT \\n' +\n  '          m.*,\\n' +\n  '          COALESCE(\\n' +\n  '            json_agg(\\n' +\n  '              json_build_object(\\n' +\n  \"                'id', mi.id,\\n\" +\n  \"                'name', mi.name,\\n\" +\n  \"                'price', mi.price,\\n\" +\n  \"                'available', mi.available\\n\" +\n  '              )\\n' +\n  '            ) FILTER (WHERE mi.id IS NOT NULL),\\n' +\n  \"            '[]'::json\\n\" +\n  '          ) as items\\n' +\n  '        FROM menus m\\n' +\n  '        LEFT JOIN menu_items mi ON m.id = mi.menu_id AND mi.available = true\\n' +\n  '       WHERE m.restaurant_id = $1\\n' +\n  '        GROUP BY m.id, m.restaurant_id, m.name, m.description, m.version, m.last_updated, m.created_at\\n' +\n  '        ORDER BY m.restaurant_id, m.name\\n' +\n  '      ', [ 'NYC-DELI-001' ], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at MenuService.getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\menuService.js:38:37)\n    at getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\menuController.js:15:38)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:84:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-10-09 09:12:12"}
{"body":{},"error":"SQLITE_ERROR: unrecognized token: \":\"","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"GET","path":"/api/v1/menu","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: unrecognized token: \":\"\n--> in Database#all('\\n' +\n  '        SELECT \\n' +\n  '          m.*,\\n' +\n  '          COALESCE(\\n' +\n  '            json_agg(\\n' +\n  '              json_build_object(\\n' +\n  \"                'id', mi.id,\\n\" +\n  \"                'name', mi.name,\\n\" +\n  \"                'price', mi.price,\\n\" +\n  \"                'available', mi.available\\n\" +\n  '              )\\n' +\n  '            ) FILTER (WHERE mi.id IS NOT NULL),\\n' +\n  \"            '[]'::json\\n\" +\n  '          ) as items\\n' +\n  '        FROM menus m\\n' +\n  '        LEFT JOIN menu_items mi ON m.id = mi.menu_id AND mi.available = true\\n' +\n  '       WHERE m.restaurant_id = $1\\n' +\n  '        GROUP BY m.id, m.restaurant_id, m.name, m.description, m.version, m.last_updated, m.created_at\\n' +\n  '        ORDER BY m.restaurant_id, m.name\\n' +\n  '      ', [ 'NYC-DELI-001' ], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at MenuService.getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\menuService.js:38:37)\n    at getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\menuController.js:15:38)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:84:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-10-09 09:12:12","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:17:51"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:17:51"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:17:51"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:17:51"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:17:51"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:05"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:05"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:18"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:18"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:18"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:18"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:18"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:36"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:42:36"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:15"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:15"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:15"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:15"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:15"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:15","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:38","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:38"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 09:45:38"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:05:17","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:05:17"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:05:17"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:05:42","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:05:42"}
{"client":"Mobile App","externalOrderId":"TEST-002","itemCount":1,"level":"info","message":"Creating order ORD-20241009-002","orderId":"ORD-20241009-002","orderType":"pickup","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:05:42","total":14.03}
{"__augmented":true,"code":"SQLITE_CONSTRAINT","errno":19,"level":"error","message":"Failed to create order: SQLITE_CONSTRAINT: NOT NULL constraint failed: order_items.order_id","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: NOT NULL constraint failed: order_items.order_id\n--> in Statement#run([\n  '1aea3cb3-4fb1-47c4-b2bf-6f77dd609df6',\n  undefined,\n  'SANDWICH-001',\n  'Turkey Club',\n  1,\n  12.99,\n  12.99,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:36:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:35:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:66:43)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:56:21)","timestamp":"2025-10-09 10:05:42"}
{"body":{"customer":{"name":"Test Customer","phone":"555-0123"},"externalOrderId":"TEST-002","items":[{"itemId":"SANDWICH-001","name":"Turkey Club","quantity":1,"totalPrice":12.99,"unitPrice":12.99}],"orderId":"ORD-20241009-002","orderTime":"2025-10-09T10:05:42Z","orderType":"pickup","restaurantId":"NYC-DELI-001","totals":{"subtotal":12.99,"tax":1.04,"total":14.03}},"error":"SQLITE_CONSTRAINT: NOT NULL constraint failed: order_items.order_id","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: NOT NULL constraint failed: order_items.order_id\n--> in Statement#run([\n  '1aea3cb3-4fb1-47c4-b2bf-6f77dd609df6',\n  undefined,\n  'SANDWICH-001',\n  'Turkey Club',\n  1,\n  12.99,\n  12.99,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:36:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:35:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:66:43)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:56:21)","timestamp":"2025-10-09 10:05:42","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:23:45"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:23:45"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:23:45"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:23:45"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:23:45"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:07","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:07"}
{"client":"Mobile App","externalOrderId":"TEST-003","itemCount":1,"level":"info","message":"Creating order ORD-20241009-003","orderId":"ORD-20241009-003","orderType":"pickup","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:07","total":14.03}
{"level":"info","message":"Order record created with internal ID: 0d93de99-d2a6-4900-802f-ef93e0da88bf","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:07"}
{"level":"info","message":"Order created successfully: ORD-20241009-003","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:07"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:23","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:23"}
{"client":"Mobile App","externalOrderId":"TEST-004","itemCount":1,"level":"info","message":"Creating order ORD-20241009-004","orderId":"ORD-20241009-004","orderType":"delivery","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:23","total":31.32}
{"level":"info","message":"Order record created with internal ID: a4c0bfb8-8e1d-436f-bd5f-e1e547b489df","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:23"}
{"level":"info","message":"Order created successfully: ORD-20241009-004","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:24:23"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders/ORD-20241009-004","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:29:51","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20241009-004","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:29:51"}
{"client":"Mobile App","level":"info","message":"Retrieving order ORD-20241009-004","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:29:51"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"PUT /api/v1/orders/ORD-20241009-004/status","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:30:10","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"POS Sync Agent","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20241009-004/status","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:30:10"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:30:18","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:30:27","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders/ORD-20241009-004/status","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:30:48","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20241009-004/status","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:30:48"}
{"client":"Mobile App","level":"info","message":"Retrieving order status ORD-20241009-004","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:30:48"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders/ORD-20241009-003/cancel","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:00","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"POS Sync Agent","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20241009-003/cancel","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:00"}
{"client":"POS Sync Agent","ip":"::ffff:127.0.0.1","level":"warn","message":"Authorization failed: Insufficient permissions","path":"/ORD-20241009-003/cancel","requiredPermission":"orders:create","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:00","userPermissions":["orders:update","status:webhook"]}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders/ORD-20241009-003/cancel","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:18","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Admin Dashboard","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20241009-003/cancel","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:18"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders/ORD-20241009-003/cancel","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:56","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Admin Dashboard","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20241009-003/cancel","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:56"}
{"client":"Admin Dashboard","level":"info","message":"Cancelling order ORD-20241009-003","notes":"Customer called to cancel order due to change in plans","reason":"customer_request","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:56"}
{"level":"info","message":"Order ORD-20241009-003 cancelled - reason: customer_request","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:56"}
{"level":"info","message":"Status change notification: ORD-20241009-003 -> cancelled","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:31:56"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders/ORD-20241009-003/status","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:32:31","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20241009-003/status","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:32:31"}
{"client":"Mobile App","level":"info","message":"Retrieving order status ORD-20241009-003","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:32:31"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:50:44","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 10:50:44"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:24"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:24"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:24"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:24"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:24"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:26","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:26","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:26","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:26"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:43:26"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:09"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:09"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:09"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:09"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:09"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:11","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:11","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:11","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:11"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:11"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:18","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /favicon.ico","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:18","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:31","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:46","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"}
{"ip":"::ffff:127.0.0.1","level":"warn","message":"Authentication failed: No API key provided","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-09 18:53:46","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:06:44"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:06:45"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:06:45"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:06:45"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:06:45"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:07:46","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:08:02","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:08:55","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"warn","message":"Authentication failed: No API key provided","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:08:55","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:09:35","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:09:35"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:09:35"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:14:46"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:14:46"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:15:00"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:15:00"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:15:00"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:15:00"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:15:00"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:15:14","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:15:41","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:16:37","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:16:37"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:16:37"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:19:38","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:19:38"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:20:48","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:20:48"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:21:32","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:21:32"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:21:49","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:21:49"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:22:10","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:22:10"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:25:07"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:25:07"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:31:05"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:31:05"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:31:05"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:31:05"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:31:05"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:31:29","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:31:44","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:32:37","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:32:37"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:32:37"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:34:02"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:34:02"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:34:51"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:34:51"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:34:51"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:34:51"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:34:51"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:35:00","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:35:12","userAgent":"PostmanRuntime/7.48.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:35:44","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:35:44"}
{"client":"Mobile App","level":"info","message":"Retrieving menu","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:35:44"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:37:30","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:37:30"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:38:02","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:38:02"}
{"client":"Mobile App","externalOrderId":"POSTMAN-TEST-001","itemCount":2,"level":"info","message":"Creating order ORD-20251010-001","orderId":"ORD-20251010-001","orderType":"delivery","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:38:02","total":40.28}
{"level":"info","message":"Order record created with internal ID: 4e06255f-2760-4e86-b2ad-d7674001801a","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:38:02"}
{"level":"info","message":"Order created successfully: ORD-20251010-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:38:02"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders/ORD-20251010-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:38:49","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20251010-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:38:49"}
{"client":"Mobile App","level":"info","message":"Retrieving order ORD-20251010-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:38:49"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"PATCH /api/v1/orders/ORD-20251010-001/status","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:40:12","userAgent":"PostmanRuntime/7.48.0"}
{"client":"POS Sync Agent","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20251010-001/status","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:40:12"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"PATCH /api/v1/orders/ORD-20251010-001/status","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:40:55","userAgent":"PostmanRuntime/7.48.0"}
{"client":"POS Sync Agent","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20251010-001/status","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:40:55"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"PUT /api/v1/orders/ORD-20251010-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:43:10","userAgent":"PostmanRuntime/7.48.0"}
{"client":"POS Sync Agent","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/ORD-20251010-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:43:10"}
{"client":"POS Sync Agent","level":"info","message":"Updating order ORD-20251010-001","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:43:10","updates":{"notes":"Order received by kitchen","status":"preparing"}}
{"level":"info","message":"Order ORD-20251010-001 status updated to preparing","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:43:10"}
{"level":"info","message":"Status change notification: ORD-20251010-001 -> preparing","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:43:10"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:43:55","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Admin Dashboard","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:43:55"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:07","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Admin Dashboard","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:07"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:08","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Admin Dashboard","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:08"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:13"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:13"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:17"}
{"level":"info","message":"üìñ API Documentation: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:17"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:17"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:17"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:17"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:23","userAgent":"PostmanRuntime/7.48.0"}
{"client":"Admin Dashboard","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:23"}
{"client":"Admin Dashboard","level":"info","limit":"5","message":"Retrieving all orders","offset":0,"service":"pos-order-gateway-api","timestamp":"2025-10-10 10:49:23"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/menu","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:50:25","userAgent":"PostmanRuntime/7.48.0"}
{"apiKeyPrefix":"invalid-...","ip":"::ffff:127.0.0.1","level":"warn","message":"Authentication failed: Invalid API key","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-10 10:50:25","userAgent":"PostmanRuntime/7.48.0"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-10 11:05:22"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-10 11:05:22"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 00:08:32"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 00:08:32"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 00:08:32"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 00:08:32"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 00:08:32"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 00:08:38"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 00:08:38"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:06:03"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:06:03"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:06:03"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:06:03"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:06:03"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:06:33"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:06:33"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:11:46"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:11:46"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:11:46"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:11:46"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:11:46"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:12:17"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:12:17"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:14:38"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:14:38"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:14:38"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:14:38"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:14:38"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:15:28"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:15:28"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:18:57"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:18:57"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:18:57"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:18:57"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:18:57"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:19:34"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:19:34"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:21:32"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:21:32"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:21:32"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:21:32"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:21:32"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:21:46","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:23:05","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:23:05"}
{"error":"Cannot read properties of undefined (reading 'processOrderItems')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"name":"Local Test User","phone":"555-LOCAL"},"externalOrderId":"LOCAL-SIMPLE-20251030032305","total":18.5},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:23:05"}
{"body":{"customer":{"name":"Local Test User","phone":"555-LOCAL"},"externalOrderId":"LOCAL-SIMPLE-20251030032305","total":18.5},"error":"Cannot read properties of undefined (reading 'processOrderItems')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:23:05","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:24:41","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:24:41"}
{"error":"Cannot read properties of undefined (reading 'processOrderItems')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"name":"Fixed Local User","phone":"555-FIXED"},"externalOrderId":"LOCAL-FIXED-032441","total":22.75},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:24:41"}
{"body":{"customer":{"name":"Fixed Local User","phone":"555-FIXED"},"externalOrderId":"LOCAL-FIXED-032441","total":22.75},"error":"Cannot read properties of undefined (reading 'processOrderItems')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:24:41","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:27:43","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:27:43"}
{"error":"Cannot read properties of undefined (reading 'processOrderItems')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"name":"Method Fix User","phone":"555-METHODFIX"},"externalOrderId":"LOCAL-METHODFIX-032743","total":29.99},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:27:43"}
{"body":{"customer":{"name":"Method Fix User","phone":"555-METHODFIX"},"externalOrderId":"LOCAL-METHODFIX-032743","total":29.99},"error":"Cannot read properties of undefined (reading 'processOrderItems')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:27:43","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:33:57","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"body":{},"error":"Unexpected token '\"', \"\"{\\\"orderI\"... is not valid JSON","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"SyntaxError: Unexpected token '\"', \"\"{\\\"orderI\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at createStrictSyntaxError (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\body-parser\\lib\\types\\json.js:169:10)\n    at parse (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\body-parser\\lib\\types\\json.js:86:15)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\body-parser\\lib\\read.js:128:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\raw-body\\index.js:238:16)\n    at done (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)","timestamp":"2025-10-30 03:34:39","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:35:31"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:35:31"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:35:31"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:35:31"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:35:31"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:36:07"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:36:07"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:36:40"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:36:40"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:36:40"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:36:40"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:36:40"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:37:02"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:37:02"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:37:28"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:37:28"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:37:28"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:37:28"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:37:28"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:40:59","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:41:28","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:41:28"}
{"level":"info","message":"Processing order data:","orderData":{"customer":{"email":"fixed@test.com","name":"Fixed Test User","phone":"555-FIXED"},"orderId":"FIXED-TEST-20251030-034127","orderType":"pickup","total":19.99},"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:41:28"}
{"error":"Cannot read properties of undefined (reading 'processOrderItems')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"email":"fixed@test.com","name":"Fixed Test User","phone":"555-FIXED"},"orderId":"FIXED-TEST-20251030-034127","orderType":"pickup","total":19.99},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:43:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:41:28"}
{"body":{"customer":{"email":"fixed@test.com","name":"Fixed Test User","phone":"555-FIXED"},"orderId":"FIXED-TEST-20251030-034127","orderType":"pickup","total":19.99},"error":"Cannot read properties of undefined (reading 'processOrderItems')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:43:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:41:28","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:42:42"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:42:42"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:42:42"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:42:42"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:42:42"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:43:43"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:43:43"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:47:42"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:47:42"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:47:42"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:47:42"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:47:42"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:48:22"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:48:22"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:48:45"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:48:45"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:48:45"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:48:45"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:48:45"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /health","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:01","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:37","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:37"}
{"level":"info","message":"Processing order data:","orderData":{"customer":{"email":"persistent@test.com","name":"Persistent Test User","phone":"555-PERSIST"},"orderId":"PERSISTENT-TEST-20251030-034937","orderType":"pickup","total":32.99},"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:37"}
{"level":"info","message":"Processed order ready for service:","processedOrder":{"customer":{"email":"persistent@test.com","name":"Persistent Test User","phone":"555-PERSIST"},"externalOrderId":"PERSISTENT-TEST-20251030-034937","items":[],"notes":"","orderId":"PERSISTENT-TEST-20251030-034937","orderTime":"2025-10-30T03:49:37.328Z","orderType":"pickup","payment":{"method":null,"status":"pending","transactionId":null},"requestedTime":null,"restaurantId":"NYC-DELI-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":0,"tax":0,"tip":0,"total":32.99}},"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:37"}
{"client":"Mobile App","customerEmail":"persistent@test.com","externalOrderId":"PERSISTENT-TEST-20251030-034937","itemCount":0,"level":"info","message":"Creating enhanced order PERSISTENT-TEST-20251030-034937","orderId":"PERSISTENT-TEST-20251030-034937","orderType":"pickup","paymentStatus":"pending","requestedTime":null,"restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:37","total":32.99}
{"customer":{"email":"persistent@test.com","name":"Persistent Test User","phone":"555-PERSIST"},"externalOrderId":"PERSISTENT-TEST-20251030-034937","internalId":"507145e9-be0d-4bec-8480-d85332bc11a5","level":"info","message":"Creating order with data:","orderId":"PERSISTENT-TEST-20251030-034937","orderType":"pickup","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:37","totals":{"deliveryFee":0,"discount":0,"subtotal":0,"tax":0,"tip":0,"total":32.99}}
{"level":"info","message":"Order main record inserted successfully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:37"}
{"level":"info","message":"Order created successfully: PERSISTENT-TEST-20251030-034937","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:49:37"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:46","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:46"}
{"level":"info","message":"Processing order data:","orderData":{"customer":{"email":"enhanced@test.com","name":"Enhanced Test User","phone":"555-ENHANCED"},"items":[{"itemId":"BURGER-001","modifiers":[{"name":"Extra Cheese","price":1.5},{"name":"Bacon","price":2}],"name":"Classic Burger","quantity":2,"totalPrice":25.98,"unitPrice":12.99},{"itemId":"FRIES-001","name":"French Fries","quantity":1,"totalPrice":4.99,"unitPrice":4.99}],"orderId":"ENHANCED-TEST-20251030-035046","orderType":"dine-in","requestedTime":"2025-10-30T15:00:00Z","totals":{"subtotal":30.97,"tax":2.48,"tip":5,"total":38.45}},"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:46"}
{"level":"info","message":"Processed order ready for service:","processedOrder":{"customer":{"email":"enhanced@test.com","name":"Enhanced Test User","phone":"555-ENHANCED"},"externalOrderId":"ENHANCED-TEST-20251030-035046","items":[{"itemId":"BURGER-001","modifiers":[{"name":"Extra Cheese","price":1.5},{"name":"Bacon","price":2}],"name":"Classic Burger","quantity":2,"specialInstructions":null,"totalPrice":25.98,"unitPrice":12.99},{"itemId":"FRIES-001","modifiers":[],"name":"French Fries","quantity":1,"specialInstructions":null,"totalPrice":4.99,"unitPrice":4.99}],"notes":"","orderId":"ENHANCED-TEST-20251030-035046","orderTime":"2025-10-30T03:50:46.926Z","orderType":"dine-in","payment":{"method":null,"status":"pending","transactionId":null},"requestedTime":"2025-10-30T15:00:00Z","restaurantId":"NYC-DELI-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":30.97,"tax":2.48,"tip":5,"total":38.45}},"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:46"}
{"client":"Mobile App","customerEmail":"enhanced@test.com","externalOrderId":"ENHANCED-TEST-20251030-035046","itemCount":2,"level":"info","message":"Creating enhanced order ENHANCED-TEST-20251030-035046","orderId":"ENHANCED-TEST-20251030-035046","orderType":"dine-in","paymentStatus":"pending","requestedTime":"2025-10-30T15:00:00Z","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:46","total":38.45}
{"customer":{"email":"enhanced@test.com","name":"Enhanced Test User","phone":"555-ENHANCED"},"externalOrderId":"ENHANCED-TEST-20251030-035046","internalId":"7b8b810d-f161-479d-bf1d-dcd098f67bd3","level":"info","message":"Creating order with data:","orderId":"ENHANCED-TEST-20251030-035046","orderType":"dine-in","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:46","totals":{"deliveryFee":0,"discount":0,"subtotal":30.97,"tax":2.48,"tip":5,"total":38.45}}
{"level":"info","message":"Order main record inserted successfully","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:46"}
{"level":"info","message":"Inserted 2 items for order ENHANCED-TEST-20251030-035046","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:47"}
{"level":"info","message":"Order created successfully: ENHANCED-TEST-20251030-035046","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:50:47"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:02","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:02"}
{"client":"Mobile App","level":"info","limit":10,"message":"Retrieving all orders","offset":0,"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:02"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"DELETE /api/v1/orders/all","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:37","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/all","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:37"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"warn","message":"Delete all orders requested","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:37","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"level":"info","message":"Deleted all order item modifiers","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:37"}
{"level":"info","message":"Deleted all order items","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:37"}
{"level":"info","message":"Successfully deleted all orders - 6 orders removed","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:37"}
{"client":"Mobile App","deletedCount":6,"level":"warn","message":"All orders deleted successfully - 6 orders removed","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:37"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"GET /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:52","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:52"}
{"client":"Mobile App","level":"info","limit":10,"message":"Retrieving all orders","offset":0,"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:51:52"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:52:16","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:52:16"}
{"level":"info","message":"Processing order data:","orderData":{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","items":[{"itemId":"SANDWICH-TURKEY","modifiers":[{"name":"Extra Turkey","price":2.5},{"name":"Avocado","price":1.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"Extra mayo","totalPrice":13.99,"unitPrice":13.99},{"itemId":"DRINK-COKE","name":"Coca Cola","quantity":2,"totalPrice":5.98,"unitPrice":2.99}],"notes":"Customer prefers pickup at side door","orderId":"WEBHOOK-20251030-035215","orderTime":"2025-10-30T03:52:15Z","orderType":"pickup","payment":{"method":"credit_card","status":"completed","transactionId":"TXN-789456"},"requestedTime":"2025-10-30T04:52:16Z","status":"confirmed","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}},"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:52:16"}
{"level":"info","message":"Processed order ready for service:","processedOrder":{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","items":[{"itemId":"SANDWICH-TURKEY","modifiers":[{"name":"Extra Turkey","price":2.5},{"name":"Avocado","price":1.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"Extra mayo","totalPrice":13.99,"unitPrice":13.99},{"itemId":"DRINK-COKE","modifiers":[],"name":"Coca Cola","quantity":2,"specialInstructions":null,"totalPrice":5.98,"unitPrice":2.99}],"notes":"Customer prefers pickup at side door","orderId":"WEBHOOK-20251030-035215","orderTime":"2025-10-30T03:52:15Z","orderType":"pickup","payment":{"method":"credit_card","status":"completed","transactionId":"TXN-789456"},"requestedTime":"2025-10-30T04:52:16Z","restaurantId":"NYC-DELI-001","status":"confirmed","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}},"service":"pos-order-gateway-api","timestamp":"2025-10-30 03:52:16"}
{"client":"Mobile App","customerEmail":"john@webhook.test","externalOrderId":"CLOVER-12345","itemCount":2,"level":"info","message":"Creating enhanced order WEBHOOK-20251030-035215","orderId":"WEBHOOK-20251030-035215","orderType":"pickup","paymentStatus":"completed","requestedTime":"2025-10-30T04:52:16Z","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:52:16","total":24.57}
{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","internalId":"b05ab123-5b90-4c04-ae73-152e859ed699","level":"info","message":"Creating order with data:","orderId":"WEBHOOK-20251030-035215","orderType":"pickup","service":"pos-order-gateway-api","timestamp":"2025-10-30 03:52:16","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","level":"error","message":"Failed to create order in service:","orderData":{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","orderId":"WEBHOOK-20251030-035215","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}},"service":"pos-order-gateway-api","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b05ab123-5b90-4c04-ae73-152e859ed699',\n  'WEBHOOK-20251030-035215',\n  'CLOVER-12345',\n  'NYC-DELI-001',\n  'a89c6652-50fb-441c-a7b2-e1c36e7ea897',\n  'John Webhook Customer',\n  '555-WEBHOOK',\n  'john@webhook.test',\n  'pickup',\n  '2025-10-30T03:52:15Z',\n  '2025-10-30T04:52:16Z',\n  19.97,\n  1.6,\n  3,\n  0,\n  0,\n  24.57,\n  'credit_card',\n  'completed',\n  'TXN-789456',\n  'Customer prefers pickup at side door',\n  'confirmed'\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:32:42)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:93:21)","timestamp":"2025-10-30 03:52:16"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","items":[{"itemId":"SANDWICH-TURKEY","modifiers":[{"name":"Extra Turkey","price":2.5},{"name":"Avocado","price":1.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"Extra mayo","totalPrice":13.99,"unitPrice":13.99},{"itemId":"DRINK-COKE","name":"Coca Cola","quantity":2,"totalPrice":5.98,"unitPrice":2.99}],"notes":"Customer prefers pickup at side door","orderId":"WEBHOOK-20251030-035215","orderTime":"2025-10-30T03:52:15Z","orderType":"pickup","payment":{"method":"credit_card","status":"completed","transactionId":"TXN-789456"},"requestedTime":"2025-10-30T04:52:16Z","status":"confirmed","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b05ab123-5b90-4c04-ae73-152e859ed699',\n  'WEBHOOK-20251030-035215',\n  'CLOVER-12345',\n  'NYC-DELI-001',\n  'a89c6652-50fb-441c-a7b2-e1c36e7ea897',\n  'John Webhook Customer',\n  '555-WEBHOOK',\n  'john@webhook.test',\n  'pickup',\n  '2025-10-30T03:52:15Z',\n  '2025-10-30T04:52:16Z',\n  19.97,\n  1.6,\n  3,\n  0,\n  0,\n  24.57,\n  'credit_card',\n  'completed',\n  'TXN-789456',\n  'Customer prefers pickup at side door',\n  'confirmed'\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:32:42)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:93:21)","timestamp":"2025-10-30 03:52:16"}
{"body":{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","items":[{"itemId":"SANDWICH-TURKEY","modifiers":[{"name":"Extra Turkey","price":2.5},{"name":"Avocado","price":1.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"Extra mayo","totalPrice":13.99,"unitPrice":13.99},{"itemId":"DRINK-COKE","name":"Coca Cola","quantity":2,"totalPrice":5.98,"unitPrice":2.99}],"notes":"Customer prefers pickup at side door","orderId":"WEBHOOK-20251030-035215","orderTime":"2025-10-30T03:52:15Z","orderType":"pickup","payment":{"method":"credit_card","status":"completed","transactionId":"TXN-789456"},"requestedTime":"2025-10-30T04:52:16Z","status":"confirmed","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b05ab123-5b90-4c04-ae73-152e859ed699',\n  'WEBHOOK-20251030-035215',\n  'CLOVER-12345',\n  'NYC-DELI-001',\n  'a89c6652-50fb-441c-a7b2-e1c36e7ea897',\n  'John Webhook Customer',\n  '555-WEBHOOK',\n  'john@webhook.test',\n  'pickup',\n  '2025-10-30T03:52:15Z',\n  '2025-10-30T04:52:16Z',\n  19.97,\n  1.6,\n  3,\n  0,\n  0,\n  24.57,\n  'credit_card',\n  'completed',\n  'TXN-789456',\n  'Customer prefers pickup at side door',\n  'confirmed'\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:32:42)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:93:21)","timestamp":"2025-10-30 03:52:16","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:91.231.89.109","level":"info","message":"GET /","service":"pos-order-gateway-api","timestamp":"2025-10-30 04:16:12","userAgent":"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:134.0) Gecko/20100101 Firefox/134.0"}
{"ip":"::ffff:91.196.152.9","level":"info","message":"GET /favicon.ico","service":"pos-order-gateway-api","timestamp":"2025-10-30 04:24:22","userAgent":"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:134.0) Gecko/20100101 Firefox/134.0"}
{"ip":"::ffff:127.0.0.1","level":"info","message":"POST /api/v1/orders","service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45"}
{"level":"info","message":"Processing order data:","orderData":{"customer":{"email":"jane@webhook.test","name":"Jane Webhook Customer","phone":"555-WEBHOOK2"},"externalOrderId":"CLOVER-12346","items":[{"itemId":"SANDWICH-TURKEY","modifiers":[{"name":"Extra Turkey","price":2.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"Extra mayo","totalPrice":13.99,"unitPrice":13.99},{"itemId":"DRINK-COKE","name":"Coca Cola","quantity":1,"totalPrice":2.99,"unitPrice":2.99}],"notes":"Customer prefers pickup at side door","orderId":"WEBHOOK-FIXED-20251030-165245","orderType":"pickup","payment":{"method":"credit_card","status":"captured","transactionId":"TXN-789457"},"requestedTime":"2025-10-30T17:52:45Z","totals":{"subtotal":16.98,"tax":1.36,"tip":2.5,"total":20.84}},"service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45"}
{"level":"info","message":"Processed order ready for service:","processedOrder":{"customer":{"email":"jane@webhook.test","name":"Jane Webhook Customer","phone":"555-WEBHOOK2"},"externalOrderId":"CLOVER-12346","items":[{"itemId":"SANDWICH-TURKEY","modifiers":[{"name":"Extra Turkey","price":2.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"Extra mayo","totalPrice":13.99,"unitPrice":13.99},{"itemId":"DRINK-COKE","modifiers":[],"name":"Coca Cola","quantity":1,"specialInstructions":null,"totalPrice":2.99,"unitPrice":2.99}],"notes":"Customer prefers pickup at side door","orderId":"WEBHOOK-FIXED-20251030-165245","orderTime":"2025-10-30T16:52:45.459Z","orderType":"pickup","payment":{"method":"credit_card","status":"captured","transactionId":"TXN-789457"},"requestedTime":"2025-10-30T17:52:45Z","restaurantId":"NYC-DELI-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":16.98,"tax":1.36,"tip":2.5,"total":20.84}},"service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45"}
{"client":"Mobile App","customerEmail":"jane@webhook.test","externalOrderId":"CLOVER-12346","itemCount":2,"level":"info","message":"Creating enhanced order WEBHOOK-FIXED-20251030-165245","orderId":"WEBHOOK-FIXED-20251030-165245","orderType":"pickup","paymentStatus":"captured","requestedTime":"2025-10-30T17:52:45Z","restaurantId":"NYC-DELI-001","service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45","total":20.84}
{"customer":{"email":"jane@webhook.test","name":"Jane Webhook Customer","phone":"555-WEBHOOK2"},"externalOrderId":"CLOVER-12346","internalId":"b0b87f4c-dc02-479f-aa46-e650755bafb0","level":"info","message":"Creating order with data:","orderId":"WEBHOOK-FIXED-20251030-165245","orderType":"pickup","service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45","totals":{"deliveryFee":0,"discount":0,"subtotal":16.98,"tax":1.36,"tip":2.5,"total":20.84}}
{"level":"info","message":"Order main record inserted successfully","service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45"}
{"level":"info","message":"Inserted 2 items for order WEBHOOK-FIXED-20251030-165245","service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45"}
{"level":"info","message":"Order created successfully: WEBHOOK-FIXED-20251030-165245","service":"pos-order-gateway-api","timestamp":"2025-10-30 16:52:45"}
{"ip":"::ffff:91.224.92.34","level":"info","message":"GET /","service":"pos-order-gateway-api","timestamp":"2025-11-01 03:22:06","userAgent":"Go-http-client/1.1"}
{"ip":"::ffff:91.224.92.34","level":"info","message":"GET /api/contents","service":"pos-order-gateway-api","timestamp":"2025-11-01 03:22:07","userAgent":"Go-http-client/1.1"}
{"ip":"::ffff:64.62.156.182","level":"info","message":"GET /","service":"pos-order-gateway-api","timestamp":"2025-11-01 04:41:17","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0"}
{"ip":"::ffff:64.62.156.185","level":"info","message":"GET /favicon.ico","service":"pos-order-gateway-api","timestamp":"2025-11-01 04:41:32","userAgent":"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0"}
{"ip":"::ffff:79.124.40.174","level":"info","message":"GET /","service":"pos-order-gateway-api","timestamp":"2025-11-01 05:00:02","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:18:47"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:18:47"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:18:47"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:18:47"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:18:47"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:20:23"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:20:23"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:22:19"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:22:19"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:22:19"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:22:19"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:22:19"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:26:05"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-11-03 08:26:05"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:11"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:11"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:11"}
{"level":"info","message":"‚úÖ Executed: PRAGMA table_info(orders)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:11"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:11"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:11"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:11"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:57"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:57"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:57"}
{"level":"info","message":"‚úÖ Executed: PRAGMA table_info(orders)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:57"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:57"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:57"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:40:57"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:51"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:51"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:51"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE orders ADD COLUMN customer_address TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:51"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE orders ADD COLUMN payment_amount REAL DEFAULT 0...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE orders ADD COLUMN source TEXT DEFAULT 'api'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE orders ADD COLUMN webhook_metadata TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE orders ADD COLUMN original_order_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE orders ADD COLUMN webhook_created_at TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE order_items ADD COLUMN category TEXT DEFAULT 'General'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE order_item_modifiers ADD COLUMN modifier_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: ALTER TABLE order_item_modifiers ADD COLUMN quantity INTEGER DEFAULT 1...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source ON orders(source)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_original_order_id ON orders(original_order...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source_created ON orders(source, created_a...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"26":{"cid":26,"dflt_value":null,"name":"customer_address","notnull":0,"pk":0,"type":"TEXT"},"27":{"cid":27,"dflt_value":"0","name":"payment_amount","notnull":0,"pk":0,"type":"REAL"},"28":{"cid":28,"dflt_value":"'api'","name":"source","notnull":0,"pk":0,"type":"TEXT"},"29":{"cid":29,"dflt_value":null,"name":"webhook_metadata","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"30":{"cid":30,"dflt_value":null,"name":"original_order_id","notnull":0,"pk":0,"type":"TEXT"},"31":{"cid":31,"dflt_value":null,"name":"webhook_created_at","notnull":0,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Final orders table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ All new order columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ order_items.category column is present","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ All new order_item_modifiers columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"üéØ Database structure test completed!","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"‚úÖ Database migration completed","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"üé£ OhMyApp.io webhook support: ENABLED","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:53:52"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:54:29"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-11-04 00:54:29"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN customer_address TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN payment_amount REAL DEFAULT 0...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN source TEXT DEFAULT 'api'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_metadata TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN original_order_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_created_at TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_items ADD COLUMN category TEXT DEFAULT 'General'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN modifier_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN quantity INTEGER DEFAULT 1...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source ON orders(source)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_original_order_id ON orders(original_order...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source_created ON orders(source, created_a...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"26":{"cid":26,"dflt_value":null,"name":"customer_address","notnull":0,"pk":0,"type":"TEXT"},"27":{"cid":27,"dflt_value":"0","name":"payment_amount","notnull":0,"pk":0,"type":"REAL"},"28":{"cid":28,"dflt_value":"'api'","name":"source","notnull":0,"pk":0,"type":"TEXT"},"29":{"cid":29,"dflt_value":null,"name":"webhook_metadata","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"30":{"cid":30,"dflt_value":null,"name":"original_order_id","notnull":0,"pk":0,"type":"TEXT"},"31":{"cid":31,"dflt_value":null,"name":"webhook_created_at","notnull":0,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Final orders table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚úÖ All new order columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚úÖ order_items.category column is present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚úÖ All new order_item_modifiers columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üéØ Database structure test completed!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"‚úÖ Database migration completed","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"üé£ OhMyApp.io webhook support: ENABLED","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:06:37"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:29"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:29"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN customer_address TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN payment_amount REAL DEFAULT 0...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN source TEXT DEFAULT 'api'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_metadata TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN original_order_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_created_at TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_items ADD COLUMN category TEXT DEFAULT 'General'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN modifier_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN quantity INTEGER DEFAULT 1...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source ON orders(source)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_original_order_id ON orders(original_order...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source_created ON orders(source, created_a...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"26":{"cid":26,"dflt_value":null,"name":"customer_address","notnull":0,"pk":0,"type":"TEXT"},"27":{"cid":27,"dflt_value":"0","name":"payment_amount","notnull":0,"pk":0,"type":"REAL"},"28":{"cid":28,"dflt_value":"'api'","name":"source","notnull":0,"pk":0,"type":"TEXT"},"29":{"cid":29,"dflt_value":null,"name":"webhook_metadata","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"30":{"cid":30,"dflt_value":null,"name":"original_order_id","notnull":0,"pk":0,"type":"TEXT"},"31":{"cid":31,"dflt_value":null,"name":"webhook_created_at","notnull":0,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Final orders table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚úÖ All new order columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚úÖ order_items.category column is present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚úÖ All new order_item_modifiers columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üéØ Database structure test completed!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"‚úÖ Database migration completed","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"üé£ OhMyApp.io webhook support: ENABLED","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:07:53"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:13"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:13"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN customer_address TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN payment_amount REAL DEFAULT 0...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN source TEXT DEFAULT 'api'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_metadata TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN original_order_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_created_at TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_items ADD COLUMN category TEXT DEFAULT 'General'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN modifier_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN quantity INTEGER DEFAULT 1...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source ON orders(source)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_original_order_id ON orders(original_order...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source_created ON orders(source, created_a...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"26":{"cid":26,"dflt_value":null,"name":"customer_address","notnull":0,"pk":0,"type":"TEXT"},"27":{"cid":27,"dflt_value":"0","name":"payment_amount","notnull":0,"pk":0,"type":"REAL"},"28":{"cid":28,"dflt_value":"'api'","name":"source","notnull":0,"pk":0,"type":"TEXT"},"29":{"cid":29,"dflt_value":null,"name":"webhook_metadata","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"30":{"cid":30,"dflt_value":null,"name":"original_order_id","notnull":0,"pk":0,"type":"TEXT"},"31":{"cid":31,"dflt_value":null,"name":"webhook_created_at","notnull":0,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Final orders table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚úÖ All new order columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚úÖ order_items.category column is present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚úÖ All new order_item_modifiers columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üéØ Database structure test completed!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"‚úÖ Database migration completed","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üé£ OhMyApp.io webhook support: ENABLED","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:23"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN customer_address TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN payment_amount REAL DEFAULT 0...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN source TEXT DEFAULT 'api'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_metadata TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN original_order_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_created_at TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_items ADD COLUMN category TEXT DEFAULT 'General'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN modifier_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN quantity INTEGER DEFAULT 1...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source ON orders(source)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_original_order_id ON orders(original_order...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source_created ON orders(source, created_a...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"26":{"cid":26,"dflt_value":null,"name":"customer_address","notnull":0,"pk":0,"type":"TEXT"},"27":{"cid":27,"dflt_value":"0","name":"payment_amount","notnull":0,"pk":0,"type":"REAL"},"28":{"cid":28,"dflt_value":"'api'","name":"source","notnull":0,"pk":0,"type":"TEXT"},"29":{"cid":29,"dflt_value":null,"name":"webhook_metadata","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"30":{"cid":30,"dflt_value":null,"name":"original_order_id","notnull":0,"pk":0,"type":"TEXT"},"31":{"cid":31,"dflt_value":null,"name":"webhook_created_at","notnull":0,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Final orders table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚úÖ All new order columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚úÖ order_items.category column is present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"‚úÖ All new order_item_modifiers columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:42"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:50"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:17:50"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN customer_address TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN payment_amount REAL DEFAULT 0...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN source TEXT DEFAULT 'api'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_metadata TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN original_order_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_created_at TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_items ADD COLUMN category TEXT DEFAULT 'General'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN modifier_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN quantity INTEGER DEFAULT 1...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source ON orders(source)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_original_order_id ON orders(original_order...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source_created ON orders(source, created_a...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"26":{"cid":26,"dflt_value":null,"name":"customer_address","notnull":0,"pk":0,"type":"TEXT"},"27":{"cid":27,"dflt_value":"0","name":"payment_amount","notnull":0,"pk":0,"type":"REAL"},"28":{"cid":28,"dflt_value":"'api'","name":"source","notnull":0,"pk":0,"type":"TEXT"},"29":{"cid":29,"dflt_value":null,"name":"webhook_metadata","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"30":{"cid":30,"dflt_value":null,"name":"original_order_id","notnull":0,"pk":0,"type":"TEXT"},"31":{"cid":31,"dflt_value":null,"name":"webhook_created_at","notnull":0,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Final orders table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚úÖ All new order columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚úÖ order_items.category column is present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚úÖ All new order_item_modifiers columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üéØ Database structure test completed!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"‚úÖ Database migration completed","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"level":"info","message":"üé£ OhMyApp.io webhook support: ENABLED","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:32"}
{"ip":"::ffff:127.0.0.1","ips":[],"level":"info","message":"POST /api/v1/orders","remoteAddress":"::ffff:127.0.0.1","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:48","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"apiKeyPrefix":"test-api...","ip":"::ffff:127.0.0.1","level":"warn","message":"Authentication failed: Invalid API key","path":"/","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:18:48","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","ips":[],"level":"info","message":"POST /api/v1/orders","remoteAddress":"::ffff:127.0.0.1","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:19:00","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"apiKeyPrefix":"test-api...","ip":"::ffff:127.0.0.1","level":"warn","message":"Authentication failed: Invalid API key","path":"/","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:19:00","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","ips":[],"level":"info","message":"POST /api/v1/orders","remoteAddress":"::ffff:127.0.0.1","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:19:59","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"apiKeyPrefix":"sync-age...","ip":"::ffff:127.0.0.1","level":"warn","message":"Authentication failed: Invalid API key","path":"/","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:19:59","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","ips":[],"level":"info","message":"POST /api/v1/orders","remoteAddress":"::ffff:127.0.0.1","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:22:34","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:22:34"}
{"error":"Cannot read properties of undefined (reading 'detectOhMyAppWebhook')","failedAtStep":1,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation not reached","processingTime":"3ms","requestAnalysis":{"bodyKeys":["order_type","tax","order_id","order_time","subtotal","customer_name","restaurant_id","payment_status","customer_address","external_order_id","customer_phone","payment_method","customer_email","tip","items","total"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'detectOhMyAppWebhook')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:19:37)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-11-04 01:22:34"}
{"body":{"customer_address":"123 Main St, City, State 12345","customer_email":"john@example.com","customer_name":"John Doe","customer_phone":"+1234567890","external_order_id":"EXT-TEST-20251104012234","items":[{"category":"Main Course","item_id":"ITEM-001","modifiers":[{"modifier_id":"MOD-001","name":"Extra Cheese","price":1.5,"quantity":1}],"name":"Burger","price":10,"quantity":2},{"category":"Sides","item_id":"ITEM-002","name":"Fries","price":5.5,"quantity":1}],"order_id":"TEST-20251104012234","order_time":"2025-11-04T01:22:34Z","order_type":"delivery","payment_method":"credit_card","payment_status":"paid","restaurant_id":"REST-001","subtotal":25.5,"tax":2.55,"tip":5,"total":33.05},"error":"Cannot read properties of undefined (reading 'detectOhMyAppWebhook')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'detectOhMyAppWebhook')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:19:37)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-11-04 01:22:34","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"level":"info","message":"üîí Proxy trust enabled for production deployment","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üîÑ Applying OhMyApp.io support migration...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üóÑÔ∏è Connected to SQLite database","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN customer_address TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN payment_amount REAL DEFAULT 0...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN source TEXT DEFAULT 'api'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_metadata TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN original_order_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE orders ADD COLUMN webhook_created_at TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_items ADD COLUMN category TEXT DEFAULT 'General'...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN modifier_id TEXT...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚ö†Ô∏è Skipped (already exists): ALTER TABLE order_item_modifiers ADD COLUMN quantity INTEGER DEFAULT 1...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source ON orders(source)...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_original_order_id ON orders(original_order...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚úÖ Applied: CREATE INDEX IF NOT EXISTS idx_orders_source_created ON orders(source, created_a...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"0":{"cid":0,"dflt_value":"lower(hex(randomblob(16)))","name":"id","notnull":0,"pk":1,"type":"TEXT"},"1":{"cid":1,"dflt_value":null,"name":"order_id","notnull":1,"pk":0,"type":"TEXT"},"10":{"cid":10,"dflt_value":null,"name":"requested_time","notnull":0,"pk":0,"type":"TEXT"},"11":{"cid":11,"dflt_value":null,"name":"subtotal","notnull":1,"pk":0,"type":"REAL"},"12":{"cid":12,"dflt_value":null,"name":"tax","notnull":1,"pk":0,"type":"REAL"},"13":{"cid":13,"dflt_value":"0","name":"tip","notnull":0,"pk":0,"type":"REAL"},"14":{"cid":14,"dflt_value":"0","name":"discount","notnull":0,"pk":0,"type":"REAL"},"15":{"cid":15,"dflt_value":"0","name":"delivery_fee","notnull":0,"pk":0,"type":"REAL"},"16":{"cid":16,"dflt_value":null,"name":"total","notnull":1,"pk":0,"type":"REAL"},"17":{"cid":17,"dflt_value":null,"name":"payment_method","notnull":0,"pk":0,"type":"TEXT"},"18":{"cid":18,"dflt_value":"'pending'","name":"payment_status","notnull":0,"pk":0,"type":"TEXT"},"19":{"cid":19,"dflt_value":null,"name":"payment_transaction_id","notnull":0,"pk":0,"type":"TEXT"},"2":{"cid":2,"dflt_value":null,"name":"external_order_id","notnull":1,"pk":0,"type":"TEXT"},"20":{"cid":20,"dflt_value":"'received'","name":"status","notnull":0,"pk":0,"type":"TEXT"},"21":{"cid":21,"dflt_value":null,"name":"estimated_time","notnull":0,"pk":0,"type":"TEXT"},"22":{"cid":22,"dflt_value":null,"name":"cancellation_reason","notnull":0,"pk":0,"type":"TEXT"},"23":{"cid":23,"dflt_value":null,"name":"notes","notnull":0,"pk":0,"type":"TEXT"},"24":{"cid":24,"dflt_value":"datetime('now')","name":"created_at","notnull":0,"pk":0,"type":"TEXT"},"25":{"cid":25,"dflt_value":"datetime('now')","name":"updated_at","notnull":0,"pk":0,"type":"TEXT"},"26":{"cid":26,"dflt_value":null,"name":"customer_address","notnull":0,"pk":0,"type":"TEXT"},"27":{"cid":27,"dflt_value":"0","name":"payment_amount","notnull":0,"pk":0,"type":"REAL"},"28":{"cid":28,"dflt_value":"'api'","name":"source","notnull":0,"pk":0,"type":"TEXT"},"29":{"cid":29,"dflt_value":null,"name":"webhook_metadata","notnull":0,"pk":0,"type":"TEXT"},"3":{"cid":3,"dflt_value":null,"name":"restaurant_id","notnull":1,"pk":0,"type":"TEXT"},"30":{"cid":30,"dflt_value":null,"name":"original_order_id","notnull":0,"pk":0,"type":"TEXT"},"31":{"cid":31,"dflt_value":null,"name":"webhook_created_at","notnull":0,"pk":0,"type":"TEXT"},"4":{"cid":4,"dflt_value":null,"name":"idempotency_key","notnull":1,"pk":0,"type":"TEXT"},"5":{"cid":5,"dflt_value":null,"name":"customer_name","notnull":1,"pk":0,"type":"TEXT"},"6":{"cid":6,"dflt_value":null,"name":"customer_phone","notnull":1,"pk":0,"type":"TEXT"},"7":{"cid":7,"dflt_value":null,"name":"customer_email","notnull":0,"pk":0,"type":"TEXT"},"8":{"cid":8,"dflt_value":null,"name":"order_type","notnull":1,"pk":0,"type":"TEXT"},"9":{"cid":9,"dflt_value":null,"name":"order_time","notnull":1,"pk":0,"type":"TEXT"},"level":"info","message":"üìã Final orders table structure:","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üéâ OhMyApp.io migration completed successfully!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üß™ Testing new database structure...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚úÖ All new order columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚úÖ order_items.category column is present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚úÖ All new order_item_modifiers columns are present","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üéØ Database structure test completed!","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"‚úÖ Database migration completed","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üöÄ Order Gateway API started on port 3000","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üìñ API Index: http://localhost:3000/api","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üíì Health Check: http://localhost:3000/health","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üåç Environment: development","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"level":"info","message":"üé£ OhMyApp.io webhook support: ENABLED","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:26:54"}
{"ip":"::ffff:127.0.0.1","ips":[],"level":"info","message":"POST /api/v1/orders","remoteAddress":"::ffff:127.0.0.1","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:27:09","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:27:10"}
{"level":"info","message":"Processing order data:","orderData":{"customer_address":"123 Main St, City, State 12345","customer_email":"john@example.com","customer_name":"John Doe","customer_phone":"+1234567890","external_order_id":"EXT-TEST-20251104012709","items":[{"category":"Main Course","item_id":"ITEM-001","modifiers":[{"modifier_id":"MOD-001","name":"Extra Cheese","price":1.5,"quantity":1}],"name":"Burger","price":10,"quantity":2},{"category":"Sides","item_id":"ITEM-002","name":"Fries","price":5.5,"quantity":1}],"order_id":"TEST-20251104012709","order_time":"2025-11-04T01:27:09Z","order_type":"delivery","payment_method":"credit_card","payment_status":"paid","restaurant_id":"REST-001","subtotal":25.5,"tax":2.55,"tip":5,"total":33.05},"service":"pos-order-gateway-api","timestamp":"2025-11-04 01:27:10"}
{"level":"info","message":"Processed order ready for service:","processedOrder":{"_ohmyAppFields":{"hasAddress":false,"hasServiceFee":false,"hasShippingFee":false,"hasWebhookMetadata":false},"createdAt":null,"customer":{"address":null,"email":"john@example.com","name":"John Doe","phone":"+1234567890"},"externalOrderId":"EXT-TEST-20251104012709","items":[{"itemId":"ITEM-001","modifiers":[{"name":"Extra Cheese","price":1.5}],"name":"Burger","quantity":2,"specialInstructions":null,"totalPrice":0,"unitPrice":10},{"itemId":"ITEM-002","modifiers":[],"name":"Fries","quantity":1,"specialInstructions":null,"totalPrice":0,"unitPrice":5.5}],"notes":"","orderId":"TEST-20251104012709","orderTime":"2025-11-04T01:27:09Z","orderType":"delivery","originalOrderId":null,"payment":{"amount":0,"method":"credit_card","status":"paid","transactionId":null},"requestedTime":null,"restaurantId":"REST-001","source":"api","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":25.5,"tax":2.55,"tip":5,"total":33.05},"webhookMetadata":null},"service":"pos-order-gateway-api","timestamp":"2025-11-04 01:27:10"}
{"client":"Mobile App","customerEmail":"john@example.com","externalOrderId":"EXT-TEST-20251104012709","itemCount":2,"level":"info","message":"Creating enhanced order TEST-20251104012709","orderId":"TEST-20251104012709","orderType":"delivery","paymentStatus":"paid","requestedTime":null,"restaurantId":"REST-001","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:27:10","total":33.05}
{"customer":{"address":null,"email":"john@example.com","name":"John Doe","phone":"+1234567890"},"externalOrderId":"EXT-TEST-20251104012709","internalId":"4213055a-8aa8-4e5a-a9a8-e64238ae15d7","level":"info","message":"Creating order with data:","orderId":"TEST-20251104012709","orderType":"delivery","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:27:10","totals":{"deliveryFee":0,"discount":0,"subtotal":25.5,"tax":2.55,"tip":5,"total":33.05}}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"EXT-TEST-20251104012709","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":2,"orderId":"TEST-20251104012709","totalAmount":33.05},"service":"pos-order-gateway-api","serviceProcessingTime":"12ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '4213055a-8aa8-4e5a-a9a8-e64238ae15d7',\n  'TEST-20251104012709',\n  'EXT-TEST-20251104012709',\n  'REST-001',\n  '4989e0f9-de47-45e2-b1d9-31b881ba4b7f',\n  'John Doe',\n  '+1234567890',\n  'john@example.com',\n  null,\n  'delivery',\n  '2025-11-04T01:27:09Z',\n  null,\n  25.5,\n  2.55,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'paid',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 01:27:10"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"25ms","requestAnalysis":{"bodyKeys":["order_type","tax","order_id","order_time","subtotal","customer_name","restaurant_id","payment_status","customer_address","external_order_id","customer_phone","payment_method","customer_email","tip","items","total"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '4213055a-8aa8-4e5a-a9a8-e64238ae15d7',\n  'TEST-20251104012709',\n  'EXT-TEST-20251104012709',\n  'REST-001',\n  '4989e0f9-de47-45e2-b1d9-31b881ba4b7f',\n  'John Doe',\n  '+1234567890',\n  'john@example.com',\n  null,\n  'delivery',\n  '2025-11-04T01:27:09Z',\n  null,\n  25.5,\n  2.55,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'paid',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 01:27:10"}
{"body":{"customer_address":"123 Main St, City, State 12345","customer_email":"john@example.com","customer_name":"John Doe","customer_phone":"+1234567890","external_order_id":"EXT-TEST-20251104012709","items":[{"category":"Main Course","item_id":"ITEM-001","modifiers":[{"modifier_id":"MOD-001","name":"Extra Cheese","price":1.5,"quantity":1}],"name":"Burger","price":10,"quantity":2},{"category":"Sides","item_id":"ITEM-002","name":"Fries","price":5.5,"quantity":1}],"order_id":"TEST-20251104012709","order_time":"2025-11-04T01:27:09Z","order_type":"delivery","payment_method":"credit_card","payment_status":"paid","restaurant_id":"REST-001","subtotal":25.5,"tax":2.55,"tip":5,"total":33.05},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '4213055a-8aa8-4e5a-a9a8-e64238ae15d7',\n  'TEST-20251104012709',\n  'EXT-TEST-20251104012709',\n  'REST-001',\n  '4989e0f9-de47-45e2-b1d9-31b881ba4b7f',\n  'John Doe',\n  '+1234567890',\n  'john@example.com',\n  null,\n  'delivery',\n  '2025-11-04T01:27:09Z',\n  null,\n  25.5,\n  2.55,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'paid',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 01:27:10","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"ip":"::ffff:127.0.0.1","ips":[],"level":"info","message":"POST /api/v1/orders","remoteAddress":"::ffff:127.0.0.1","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:02","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"client":"Mobile App","ip":"::ffff:127.0.0.1","level":"info","message":"Authentication successful","path":"/","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:02"}
{"level":"info","message":"Processing order data:","orderData":{"customer_address":"123 Main St, City, State 12345","customer_email":"john@example.com","customer_name":"John Doe","customer_phone":"+1234567890","external_order_id":"EXT-TEST-20251104012902","items":[{"category":"Main Course","item_id":"ITEM-001","modifiers":[{"modifier_id":"MOD-001","name":"Extra Cheese","price":1.5,"quantity":1}],"name":"Burger","price":10,"quantity":2},{"category":"Sides","item_id":"ITEM-002","name":"Fries","price":5.5,"quantity":1}],"order_id":"TEST-20251104012902","order_time":"2025-11-04T01:29:02Z","order_type":"delivery","payment_method":"credit_card","payment_status":"captured","restaurant_id":"REST-001","subtotal":25.5,"tax":2.55,"tip":5,"total":33.05},"service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:02"}
{"level":"info","message":"Processed order ready for service:","processedOrder":{"_ohmyAppFields":{"hasAddress":false,"hasServiceFee":false,"hasShippingFee":false,"hasWebhookMetadata":false},"createdAt":null,"customer":{"address":null,"email":"john@example.com","name":"John Doe","phone":"+1234567890"},"externalOrderId":"EXT-TEST-20251104012902","items":[{"itemId":"ITEM-001","modifiers":[{"name":"Extra Cheese","price":1.5}],"name":"Burger","quantity":2,"specialInstructions":null,"totalPrice":0,"unitPrice":10},{"itemId":"ITEM-002","modifiers":[],"name":"Fries","quantity":1,"specialInstructions":null,"totalPrice":0,"unitPrice":5.5}],"notes":"","orderId":"TEST-20251104012902","orderTime":"2025-11-04T01:29:02Z","orderType":"delivery","originalOrderId":null,"payment":{"amount":0,"method":"credit_card","status":"captured","transactionId":null},"requestedTime":null,"restaurantId":"REST-001","source":"api","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":25.5,"tax":2.55,"tip":5,"total":33.05},"webhookMetadata":null},"service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:02"}
{"client":"Mobile App","customerEmail":"john@example.com","externalOrderId":"EXT-TEST-20251104012902","itemCount":2,"level":"info","message":"Creating enhanced order TEST-20251104012902","orderId":"TEST-20251104012902","orderType":"delivery","paymentStatus":"captured","requestedTime":null,"restaurantId":"REST-001","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:02","total":33.05}
{"customer":{"address":null,"email":"john@example.com","name":"John Doe","phone":"+1234567890"},"externalOrderId":"EXT-TEST-20251104012902","internalId":"054f25f2-0d90-4be5-92c7-e4ff27ace2df","level":"info","message":"Creating order with data:","orderId":"TEST-20251104012902","orderType":"delivery","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:02","totals":{"deliveryFee":0,"discount":0,"subtotal":25.5,"tax":2.55,"tip":5,"total":33.05}}
{"level":"info","message":"Order main record inserted successfully","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:02"}
{"level":"info","message":"Inserted 2 items for order TEST-20251104012902","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:03"}
{"level":"info","message":"Order created successfully: TEST-20251104012902","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:29:03"}
{"level":"info","message":"Closing SQLite database...","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:30:30"}
{"level":"info","message":"SIGINT received, shutting down gracefully","service":"pos-order-gateway-api","timestamp":"2025-11-04 01:30:30"}
