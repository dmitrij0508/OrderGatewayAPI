{"__augmented":true,"code":"SQLITE_ERROR","errno":1,"level":"error","message":"Failed to get menu: SQLITE_ERROR: unrecognized token: \":\"","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: unrecognized token: \":\"\n--> in Database#all('\\n' +\n  '        SELECT \\n' +\n  '          m.*,\\n' +\n  '          COALESCE(\\n' +\n  '            json_agg(\\n' +\n  '              json_build_object(\\n' +\n  \"                'id', mi.id,\\n\" +\n  \"                'name', mi.name,\\n\" +\n  \"                'price', mi.price,\\n\" +\n  \"                'available', mi.available\\n\" +\n  '              )\\n' +\n  '            ) FILTER (WHERE mi.id IS NOT NULL),\\n' +\n  \"            '[]'::json\\n\" +\n  '          ) as items\\n' +\n  '        FROM menus m\\n' +\n  '        LEFT JOIN menu_items mi ON m.id = mi.menu_id AND mi.available = true\\n' +\n  '       WHERE m.restaurant_id = $1\\n' +\n  '        GROUP BY m.id, m.restaurant_id, m.name, m.description, m.version, m.last_updated, m.created_at\\n' +\n  '        ORDER BY m.restaurant_id, m.name\\n' +\n  '      ', [ 'NYC-DELI-001' ], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at MenuService.getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\menuService.js:38:37)\n    at getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\menuController.js:15:38)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:84:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-10-09 08:59:00"}
{"body":{},"error":"SQLITE_ERROR: unrecognized token: \":\"","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"GET","path":"/api/v1/menu","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: unrecognized token: \":\"\n--> in Database#all('\\n' +\n  '        SELECT \\n' +\n  '          m.*,\\n' +\n  '          COALESCE(\\n' +\n  '            json_agg(\\n' +\n  '              json_build_object(\\n' +\n  \"                'id', mi.id,\\n\" +\n  \"                'name', mi.name,\\n\" +\n  \"                'price', mi.price,\\n\" +\n  \"                'available', mi.available\\n\" +\n  '              )\\n' +\n  '            ) FILTER (WHERE mi.id IS NOT NULL),\\n' +\n  \"            '[]'::json\\n\" +\n  '          ) as items\\n' +\n  '        FROM menus m\\n' +\n  '        LEFT JOIN menu_items mi ON m.id = mi.menu_id AND mi.available = true\\n' +\n  '       WHERE m.restaurant_id = $1\\n' +\n  '        GROUP BY m.id, m.restaurant_id, m.name, m.description, m.version, m.last_updated, m.created_at\\n' +\n  '        ORDER BY m.restaurant_id, m.name\\n' +\n  '      ', [ 'NYC-DELI-001' ], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at MenuService.getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\menuService.js:38:37)\n    at getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\menuController.js:15:38)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:84:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-10-09 08:59:00","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"__augmented":true,"code":"SQLITE_ERROR","errno":1,"level":"error","message":"Failed to create order: SQLITE_ERROR: no such function: NOW","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: no such function: NOW\n--> in Database#all('\\n' +\n  '        INSERT INTO orders (\\n' +\n  '          id, order_id, external_order_id, restaurant_id, idempotency_key,\\n' +\n  '          customer_name, customer_phone, customer_email,\\n' +\n  '          order_type, order_time, requested_time,\\n' +\n  '          subtotal, tax, tip, discount, delivery_fee, total,\\n' +\n  '          payment_method, payment_status, payment_transaction_id,\\n' +\n  '          notes, status, created_at, updated_at\\n' +\n  '        ) VALUES (\\n' +\n  '          $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, NOW(), NOW()\\n' +\n  '        ) RETURNING *\\n' +\n  '      ', [], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:71:14)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:29:40)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:56:21)","timestamp":"2025-10-09 08:59:42"}
{"body":{"customer":{"name":"Test Customer","phone":"555-0123"},"externalOrderId":"TEST-001","items":[{"itemId":"SANDWICH-001","name":"Turkey Club","quantity":1,"totalPrice":12.99,"unitPrice":12.99}],"orderId":"ORD-20241009-001","orderTime":"2025-10-09T08:59:42Z","orderType":"pickup","restaurantId":"NYC-DELI-001","totals":{"subtotal":12.99,"tax":1.04,"total":14.03}},"error":"SQLITE_ERROR: no such function: NOW","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: no such function: NOW\n--> in Database#all('\\n' +\n  '        INSERT INTO orders (\\n' +\n  '          id, order_id, external_order_id, restaurant_id, idempotency_key,\\n' +\n  '          customer_name, customer_phone, customer_email,\\n' +\n  '          order_type, order_time, requested_time,\\n' +\n  '          subtotal, tax, tip, discount, delivery_fee, total,\\n' +\n  '          payment_method, payment_status, payment_transaction_id,\\n' +\n  '          notes, status, created_at, updated_at\\n' +\n  '        ) VALUES (\\n' +\n  '          $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, NOW(), NOW()\\n' +\n  '        ) RETURNING *\\n' +\n  '      ', [], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:71:14)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:29:40)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:56:21)","timestamp":"2025-10-09 08:59:42","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"__augmented":true,"code":"SQLITE_ERROR","errno":1,"level":"error","message":"Failed to get menu: SQLITE_ERROR: unrecognized token: \":\"","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: unrecognized token: \":\"\n--> in Database#all('\\n' +\n  '        SELECT \\n' +\n  '          m.*,\\n' +\n  '          COALESCE(\\n' +\n  '            json_agg(\\n' +\n  '              json_build_object(\\n' +\n  \"                'id', mi.id,\\n\" +\n  \"                'name', mi.name,\\n\" +\n  \"                'price', mi.price,\\n\" +\n  \"                'available', mi.available\\n\" +\n  '              )\\n' +\n  '            ) FILTER (WHERE mi.id IS NOT NULL),\\n' +\n  \"            '[]'::json\\n\" +\n  '          ) as items\\n' +\n  '        FROM menus m\\n' +\n  '        LEFT JOIN menu_items mi ON m.id = mi.menu_id AND mi.available = true\\n' +\n  '       WHERE m.restaurant_id = $1\\n' +\n  '        GROUP BY m.id, m.restaurant_id, m.name, m.description, m.version, m.last_updated, m.created_at\\n' +\n  '        ORDER BY m.restaurant_id, m.name\\n' +\n  '      ', [ 'NYC-DELI-001' ], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at MenuService.getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\menuService.js:38:37)\n    at getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\menuController.js:15:38)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:84:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-10-09 09:12:12"}
{"body":{},"error":"SQLITE_ERROR: unrecognized token: \":\"","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"GET","path":"/api/v1/menu","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: unrecognized token: \":\"\n--> in Database#all('\\n' +\n  '        SELECT \\n' +\n  '          m.*,\\n' +\n  '          COALESCE(\\n' +\n  '            json_agg(\\n' +\n  '              json_build_object(\\n' +\n  \"                'id', mi.id,\\n\" +\n  \"                'name', mi.name,\\n\" +\n  \"                'price', mi.price,\\n\" +\n  \"                'available', mi.available\\n\" +\n  '              )\\n' +\n  '            ) FILTER (WHERE mi.id IS NOT NULL),\\n' +\n  \"            '[]'::json\\n\" +\n  '          ) as items\\n' +\n  '        FROM menus m\\n' +\n  '        LEFT JOIN menu_items mi ON m.id = mi.menu_id AND mi.available = true\\n' +\n  '       WHERE m.restaurant_id = $1\\n' +\n  '        GROUP BY m.id, m.restaurant_id, m.name, m.description, m.version, m.last_updated, m.created_at\\n' +\n  '        ORDER BY m.restaurant_id, m.name\\n' +\n  '      ', [ 'NYC-DELI-001' ], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:24:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:23:10)\n    at MenuService.getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\menuService.js:38:37)\n    at getMenu (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\menuController.js:15:38)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:84:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-10-09 09:12:12","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"__augmented":true,"code":"SQLITE_CONSTRAINT","errno":19,"level":"error","message":"Failed to create order: SQLITE_CONSTRAINT: NOT NULL constraint failed: order_items.order_id","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: NOT NULL constraint failed: order_items.order_id\n--> in Statement#run([\n  '1aea3cb3-4fb1-47c4-b2bf-6f77dd609df6',\n  undefined,\n  'SANDWICH-001',\n  'Turkey Club',\n  1,\n  12.99,\n  12.99,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:36:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:35:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:66:43)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:56:21)","timestamp":"2025-10-09 10:05:42"}
{"body":{"customer":{"name":"Test Customer","phone":"555-0123"},"externalOrderId":"TEST-002","items":[{"itemId":"SANDWICH-001","name":"Turkey Club","quantity":1,"totalPrice":12.99,"unitPrice":12.99}],"orderId":"ORD-20241009-002","orderTime":"2025-10-09T10:05:42Z","orderType":"pickup","restaurantId":"NYC-DELI-001","totals":{"subtotal":12.99,"tax":1.04,"total":14.03}},"error":"SQLITE_CONSTRAINT: NOT NULL constraint failed: order_items.order_id","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: NOT NULL constraint failed: order_items.order_id\n--> in Statement#run([\n  '1aea3cb3-4fb1-47c4-b2bf-6f77dd609df6',\n  undefined,\n  'SANDWICH-001',\n  'Turkey Club',\n  1,\n  12.99,\n  12.99,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:36:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:35:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:66:43)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:56:21)","timestamp":"2025-10-09 10:05:42","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"error":"Cannot read properties of undefined (reading 'processOrderItems')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"name":"Local Test User","phone":"555-LOCAL"},"externalOrderId":"LOCAL-SIMPLE-20251030032305","total":18.5},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:23:05"}
{"body":{"customer":{"name":"Local Test User","phone":"555-LOCAL"},"externalOrderId":"LOCAL-SIMPLE-20251030032305","total":18.5},"error":"Cannot read properties of undefined (reading 'processOrderItems')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:23:05","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"error":"Cannot read properties of undefined (reading 'processOrderItems')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"name":"Fixed Local User","phone":"555-FIXED"},"externalOrderId":"LOCAL-FIXED-032441","total":22.75},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:24:41"}
{"body":{"customer":{"name":"Fixed Local User","phone":"555-FIXED"},"externalOrderId":"LOCAL-FIXED-032441","total":22.75},"error":"Cannot read properties of undefined (reading 'processOrderItems')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:24:41","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"error":"Cannot read properties of undefined (reading 'processOrderItems')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"name":"Method Fix User","phone":"555-METHODFIX"},"externalOrderId":"LOCAL-METHODFIX-032743","total":29.99},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:27:43"}
{"body":{"customer":{"name":"Method Fix User","phone":"555-METHODFIX"},"externalOrderId":"LOCAL-METHODFIX-032743","total":29.99},"error":"Cannot read properties of undefined (reading 'processOrderItems')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:41:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:27:43","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"body":{},"error":"Unexpected token '\"', \"\"{\\\"orderI\"... is not valid JSON","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"SyntaxError: Unexpected token '\"', \"\"{\\\"orderI\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at createStrictSyntaxError (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\body-parser\\lib\\types\\json.js:169:10)\n    at parse (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\body-parser\\lib\\types\\json.js:86:15)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\body-parser\\lib\\read.js:128:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\raw-body\\index.js:238:16)\n    at done (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\raw-body\\index.js:227:7)\n    at IncomingMessage.onEnd (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\raw-body\\index.js:287:7)\n    at IncomingMessage.emit (node:events:519:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)","timestamp":"2025-10-30 03:34:39","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"error":"Cannot read properties of undefined (reading 'processOrderItems')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"email":"fixed@test.com","name":"Fixed Test User","phone":"555-FIXED"},"orderId":"FIXED-TEST-20251030-034127","orderType":"pickup","total":19.99},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:43:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:41:28"}
{"body":{"customer":{"email":"fixed@test.com","name":"Fixed Test User","phone":"555-FIXED"},"orderId":"FIXED-TEST-20251030-034127","orderType":"pickup","total":19.99},"error":"Cannot read properties of undefined (reading 'processOrderItems')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'processOrderItems')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:43:21)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-10-30 03:41:28","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","level":"error","message":"Failed to create order in service:","orderData":{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","orderId":"WEBHOOK-20251030-035215","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}},"service":"pos-order-gateway-api","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b05ab123-5b90-4c04-ae73-152e859ed699',\n  'WEBHOOK-20251030-035215',\n  'CLOVER-12345',\n  'NYC-DELI-001',\n  'a89c6652-50fb-441c-a7b2-e1c36e7ea897',\n  'John Webhook Customer',\n  '555-WEBHOOK',\n  'john@webhook.test',\n  'pickup',\n  '2025-10-30T03:52:15Z',\n  '2025-10-30T04:52:16Z',\n  19.97,\n  1.6,\n  3,\n  0,\n  0,\n  24.57,\n  'credit_card',\n  'completed',\n  'TXN-789456',\n  'Customer prefers pickup at side door',\n  'confirmed'\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:32:42)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:93:21)","timestamp":"2025-10-30 03:52:16"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","level":"error","message":"Order creation failed in controller:","requestBody":{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","items":[{"itemId":"SANDWICH-TURKEY","modifiers":[{"name":"Extra Turkey","price":2.5},{"name":"Avocado","price":1.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"Extra mayo","totalPrice":13.99,"unitPrice":13.99},{"itemId":"DRINK-COKE","name":"Coca Cola","quantity":2,"totalPrice":5.98,"unitPrice":2.99}],"notes":"Customer prefers pickup at side door","orderId":"WEBHOOK-20251030-035215","orderTime":"2025-10-30T03:52:15Z","orderType":"pickup","payment":{"method":"credit_card","status":"completed","transactionId":"TXN-789456"},"requestedTime":"2025-10-30T04:52:16Z","status":"confirmed","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b05ab123-5b90-4c04-ae73-152e859ed699',\n  'WEBHOOK-20251030-035215',\n  'CLOVER-12345',\n  'NYC-DELI-001',\n  'a89c6652-50fb-441c-a7b2-e1c36e7ea897',\n  'John Webhook Customer',\n  '555-WEBHOOK',\n  'john@webhook.test',\n  'pickup',\n  '2025-10-30T03:52:15Z',\n  '2025-10-30T04:52:16Z',\n  19.97,\n  1.6,\n  3,\n  0,\n  0,\n  24.57,\n  'credit_card',\n  'completed',\n  'TXN-789456',\n  'Customer prefers pickup at side door',\n  'confirmed'\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:32:42)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:93:21)","timestamp":"2025-10-30 03:52:16"}
{"body":{"customer":{"email":"john@webhook.test","name":"John Webhook Customer","phone":"555-WEBHOOK"},"externalOrderId":"CLOVER-12345","items":[{"itemId":"SANDWICH-TURKEY","modifiers":[{"name":"Extra Turkey","price":2.5},{"name":"Avocado","price":1.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"Extra mayo","totalPrice":13.99,"unitPrice":13.99},{"itemId":"DRINK-COKE","name":"Coca Cola","quantity":2,"totalPrice":5.98,"unitPrice":2.99}],"notes":"Customer prefers pickup at side door","orderId":"WEBHOOK-20251030-035215","orderTime":"2025-10-30T03:52:15Z","orderType":"pickup","payment":{"method":"credit_card","status":"completed","transactionId":"TXN-789456"},"requestedTime":"2025-10-30T04:52:16Z","status":"confirmed","totals":{"deliveryFee":0,"discount":0,"subtotal":19.97,"tax":1.6,"tip":3,"total":24.57}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b05ab123-5b90-4c04-ae73-152e859ed699',\n  'WEBHOOK-20251030-035215',\n  'CLOVER-12345',\n  'NYC-DELI-001',\n  'a89c6652-50fb-441c-a7b2-e1c36e7ea897',\n  'John Webhook Customer',\n  '555-WEBHOOK',\n  'john@webhook.test',\n  'pickup',\n  '2025-10-30T03:52:15Z',\n  '2025-10-30T04:52:16Z',\n  19.97,\n  1.6,\n  3,\n  0,\n  0,\n  24.57,\n  'credit_card',\n  'completed',\n  'TXN-789456',\n  'Customer prefers pickup at side door',\n  'confirmed'\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:32:42)\n    at async createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:93:21)","timestamp":"2025-10-30 03:52:16","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"__augmented":true,"code":"SQLITE_ERROR","errno":1,"level":"error","message":"üí• Database structure test failed: SQLITE_ERROR: no such column: customer_address","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: no such column: customer_address\n--> in Database#all('\\n' +\n  '      SELECT \\n' +\n  '        customer_address, \\n' +\n  '        payment_amount, \\n' +\n  '        source, \\n' +\n  '        webhook_metadata, \\n' +\n  '        original_order_id, \\n' +\n  '        webhook_created_at \\n' +\n  '      FROM orders \\n' +\n  '      LIMIT 1\\n' +\n  '    ', [], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:16:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:15:10)\n    at testNewStructure (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\database\\migrate-ohmyapp-support.js:74:20)\n    at applyOhMyAppMigration (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\database\\migrate-ohmyapp-support.js:49:11)\n    at async startServer (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\server.js:177:5)","timestamp":"2025-11-04 00:40:11"}
{"__augmented":true,"code":"SQLITE_ERROR","errno":1,"level":"error","message":"üí• Database structure test failed: SQLITE_ERROR: no such column: customer_address","service":"pos-order-gateway-api","stack":"Error: SQLITE_ERROR: no such column: customer_address\n--> in Database#all('\\n' +\n  '      SELECT \\n' +\n  '        customer_address, \\n' +\n  '        payment_amount, \\n' +\n  '        source, \\n' +\n  '        webhook_metadata, \\n' +\n  '        original_order_id, \\n' +\n  '        webhook_created_at \\n' +\n  '      FROM orders \\n' +\n  '      LIMIT 1\\n' +\n  '    ', [], [Function (anonymous)])\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:16:8\n    at new Promise (<anonymous>)\n    at Object.query (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:15:10)\n    at testNewStructure (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\database\\migrate-ohmyapp-support.js:74:20)\n    at applyOhMyAppMigration (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\database\\migrate-ohmyapp-support.js:49:11)\n    at async startServer (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\server.js:177:5)","timestamp":"2025-11-04 00:40:57"}
{"error":"Cannot read properties of undefined (reading 'detectOhMyAppWebhook')","failedAtStep":1,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation not reached","processingTime":"3ms","requestAnalysis":{"bodyKeys":["order_type","tax","order_id","order_time","subtotal","customer_name","restaurant_id","payment_status","customer_address","external_order_id","customer_phone","payment_method","customer_email","tip","items","total"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'detectOhMyAppWebhook')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:19:37)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-11-04 01:22:34"}
{"body":{"customer_address":"123 Main St, City, State 12345","customer_email":"john@example.com","customer_name":"John Doe","customer_phone":"+1234567890","external_order_id":"EXT-TEST-20251104012234","items":[{"category":"Main Course","item_id":"ITEM-001","modifiers":[{"modifier_id":"MOD-001","name":"Extra Cheese","price":1.5,"quantity":1}],"name":"Burger","price":10,"quantity":2},{"category":"Sides","item_id":"ITEM-002","name":"Fries","price":5.5,"quantity":1}],"order_id":"TEST-20251104012234","order_time":"2025-11-04T01:22:34Z","order_type":"delivery","payment_method":"credit_card","payment_status":"paid","restaurant_id":"REST-001","subtotal":25.5,"tax":2.55,"tip":5,"total":33.05},"error":"Cannot read properties of undefined (reading 'detectOhMyAppWebhook')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"TypeError: Cannot read properties of undefined (reading 'detectOhMyAppWebhook')\n    at createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:19:37)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\middleware\\auth.js:68:5\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-11-04 01:22:34","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"EXT-TEST-20251104012709","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":2,"orderId":"TEST-20251104012709","totalAmount":33.05},"service":"pos-order-gateway-api","serviceProcessingTime":"12ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '4213055a-8aa8-4e5a-a9a8-e64238ae15d7',\n  'TEST-20251104012709',\n  'EXT-TEST-20251104012709',\n  'REST-001',\n  '4989e0f9-de47-45e2-b1d9-31b881ba4b7f',\n  'John Doe',\n  '+1234567890',\n  'john@example.com',\n  null,\n  'delivery',\n  '2025-11-04T01:27:09Z',\n  null,\n  25.5,\n  2.55,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'paid',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 01:27:10"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"25ms","requestAnalysis":{"bodyKeys":["order_type","tax","order_id","order_time","subtotal","customer_name","restaurant_id","payment_status","customer_address","external_order_id","customer_phone","payment_method","customer_email","tip","items","total"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '4213055a-8aa8-4e5a-a9a8-e64238ae15d7',\n  'TEST-20251104012709',\n  'EXT-TEST-20251104012709',\n  'REST-001',\n  '4989e0f9-de47-45e2-b1d9-31b881ba4b7f',\n  'John Doe',\n  '+1234567890',\n  'john@example.com',\n  null,\n  'delivery',\n  '2025-11-04T01:27:09Z',\n  null,\n  25.5,\n  2.55,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'paid',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 01:27:10"}
{"body":{"customer_address":"123 Main St, City, State 12345","customer_email":"john@example.com","customer_name":"John Doe","customer_phone":"+1234567890","external_order_id":"EXT-TEST-20251104012709","items":[{"category":"Main Course","item_id":"ITEM-001","modifiers":[{"modifier_id":"MOD-001","name":"Extra Cheese","price":1.5,"quantity":1}],"name":"Burger","price":10,"quantity":2},{"category":"Sides","item_id":"ITEM-002","name":"Fries","price":5.5,"quantity":1}],"order_id":"TEST-20251104012709","order_time":"2025-11-04T01:27:09Z","order_type":"delivery","payment_method":"credit_card","payment_status":"paid","restaurant_id":"REST-001","subtotal":25.5,"tax":2.55,"tip":5,"total":33.05},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '4213055a-8aa8-4e5a-a9a8-e64238ae15d7',\n  'TEST-20251104012709',\n  'EXT-TEST-20251104012709',\n  'REST-001',\n  '4989e0f9-de47-45e2-b1d9-31b881ba4b7f',\n  'John Doe',\n  '+1234567890',\n  'john@example.com',\n  null,\n  'delivery',\n  '2025-11-04T01:27:09Z',\n  null,\n  25.5,\n  2.55,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'paid',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (D:\\Software\\Dmitri\\Working\\POS_Mobile\\Git\\POSSyncAgent\\API\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 01:27:10","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"EXT-PICKUP-001","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":2,"orderId":"ORD-20251104055204-001","totalAmount":18.88},"service":"pos-order-gateway-api","serviceProcessingTime":"17ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '59222e08-da24-478c-a427-5622be954d6e',\n  'ORD-20251104055204-001',\n  'EXT-PICKUP-001',\n  'NYC-DELI-001',\n  'a7f70f22-4d1c-40a7-a9a2-71fb91186e85',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:52:04Z',\n  '2025-11-04T06:22:04Z',\n  17.48,\n  1.4,\n  0,\n  0,\n  0,\n  18.88,\n  'credit_card',\n  'completed',\n  'TXN-9194',\n  18.88,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:04"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"85ms","requestAnalysis":{"bodyKeys":["totals","requestedTime","orderType","restaurantId","status","customer","notes","items","externalOrderId","orderTime","payment","orderId"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '59222e08-da24-478c-a427-5622be954d6e',\n  'ORD-20251104055204-001',\n  'EXT-PICKUP-001',\n  'NYC-DELI-001',\n  'a7f70f22-4d1c-40a7-a9a2-71fb91186e85',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:52:04Z',\n  '2025-11-04T06:22:04Z',\n  17.48,\n  1.4,\n  0,\n  0,\n  0,\n  18.88,\n  'credit_card',\n  'completed',\n  'TXN-9194',\n  18.88,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:04"}
{"body":{"customer":{"email":"john.smith@example.com","name":"John Smith","phone":"555-0101"},"externalOrderId":"EXT-PICKUP-001","items":[{"itemId":"SANDWICH-001","modifiers":[{"name":"Extra Cheese","price":1.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"No mayo, extra lettuce","totalPrice":12.99,"unitPrice":12.99},{"itemId":"DRINK-001","name":"Iced Tea","quantity":1,"totalPrice":2.99,"unitPrice":2.99}],"notes":"Please call when ready","orderId":"ORD-20251104055204-001","orderTime":"2025-11-04T05:52:04Z","orderType":"pickup","payment":{"amount":18.88,"method":"credit_card","status":"completed","transactionId":"TXN-9194"},"requestedTime":"2025-11-04T06:22:04Z","restaurantId":"NYC-DELI-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":17.48,"tax":1.4,"tip":0,"total":18.88}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '59222e08-da24-478c-a427-5622be954d6e',\n  'ORD-20251104055204-001',\n  'EXT-PICKUP-001',\n  'NYC-DELI-001',\n  'a7f70f22-4d1c-40a7-a9a2-71fb91186e85',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:52:04Z',\n  '2025-11-04T06:22:04Z',\n  17.48,\n  1.4,\n  0,\n  0,\n  0,\n  18.88,\n  'credit_card',\n  'completed',\n  'TXN-9194',\n  18.88,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:04","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: order_type IN ('pickup', 'delivery', 'dine-in')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"EXT-DINEIN-003","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":3,"orderId":"ORD-20251104055205-003","totalAmount":36.82},"service":"pos-order-gateway-api","serviceProcessingTime":"9ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: order_type IN ('pickup', 'delivery', 'dine-in')\n--> in Statement#run([\n  '98d845fe-0627-4a41-b9c3-ec9c337e2f7b',\n  'ORD-20251104055205-003',\n  'EXT-DINEIN-003',\n  'NYC-BURGER-001',\n  '06f14f36-de0d-4d0a-8db6-89cfad194640',\n  'Michael Chen',\n  '555-0303',\n  'mchen@example.com',\n  null,\n  'dine_in',\n  '2025-11-04T05:52:05Z',\n  null,\n  29.46,\n  2.36,\n  5,\n  0,\n  0,\n  36.82,\n  'credit_card',\n  'completed',\n  'TXN-7492',\n  36.82,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:05"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: order_type IN ('pickup', 'delivery', 'dine-in')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"40ms","requestAnalysis":{"bodyKeys":["totals","orderType","restaurantId","status","customer","notes","items","externalOrderId","orderTime","payment","orderId"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: order_type IN ('pickup', 'delivery', 'dine-in')\n--> in Statement#run([\n  '98d845fe-0627-4a41-b9c3-ec9c337e2f7b',\n  'ORD-20251104055205-003',\n  'EXT-DINEIN-003',\n  'NYC-BURGER-001',\n  '06f14f36-de0d-4d0a-8db6-89cfad194640',\n  'Michael Chen',\n  '555-0303',\n  'mchen@example.com',\n  null,\n  'dine_in',\n  '2025-11-04T05:52:05Z',\n  null,\n  29.46,\n  2.36,\n  5,\n  0,\n  0,\n  36.82,\n  'credit_card',\n  'completed',\n  'TXN-7492',\n  36.82,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:05"}
{"body":{"customer":{"email":"mchen@example.com","name":"Michael Chen","phone":"555-0303"},"externalOrderId":"EXT-DINEIN-003","items":[{"itemId":"BURGER-001","modifiers":[{"name":"Extra Bacon","price":2},{"name":"Avocado","price":1.5}],"name":"Classic Cheeseburger","quantity":1,"specialInstructions":"Medium rare, no onions","totalPrice":14.99,"unitPrice":14.99},{"itemId":"SIDES-001","name":"French Fries","quantity":1,"totalPrice":4.99,"unitPrice":4.99},{"itemId":"SHAKE-001","name":"Chocolate Milkshake","quantity":1,"totalPrice":5.99,"unitPrice":5.99}],"notes":"Table 15","orderId":"ORD-20251104055205-003","orderTime":"2025-11-04T05:52:05Z","orderType":"dine_in","payment":{"amount":36.82,"method":"credit_card","status":"completed","transactionId":"TXN-7492"},"restaurantId":"NYC-BURGER-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":29.46,"tax":2.36,"tip":5,"total":36.82}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: order_type IN ('pickup', 'delivery', 'dine-in')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: order_type IN ('pickup', 'delivery', 'dine-in')\n--> in Statement#run([\n  '98d845fe-0627-4a41-b9c3-ec9c337e2f7b',\n  'ORD-20251104055205-003',\n  'EXT-DINEIN-003',\n  'NYC-BURGER-001',\n  '06f14f36-de0d-4d0a-8db6-89cfad194640',\n  'Michael Chen',\n  '555-0303',\n  'mchen@example.com',\n  null,\n  'dine_in',\n  '2025-11-04T05:52:05Z',\n  null,\n  29.46,\n  2.36,\n  5,\n  0,\n  0,\n  36.82,\n  'credit_card',\n  'completed',\n  'TXN-7492',\n  36.82,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:05","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"EXT-COFFEE-005","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":2,"orderId":"ORD-20251104055206-005","totalAmount":13.09},"service":"pos-order-gateway-api","serviceProcessingTime":"18ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '2a81fb73-a009-4d42-9d23-5d5b1de2c63e',\n  'ORD-20251104055206-005',\n  'EXT-COFFEE-005',\n  'NYC-CAFE-001',\n  'd7c317a5-6af6-4256-9906-0dc053880853',\n  'Emma Wilson',\n  '555-0505',\n  'emma.w@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:52:06Z',\n  '2025-11-04T06:07:06Z',\n  10.73,\n  0.86,\n  1.5,\n  0,\n  0,\n  13.09,\n  'mobile_payment',\n  'completed',\n  'TXN-8362',\n  13.09,\n  'Name: Emma',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:06"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"62ms","requestAnalysis":{"bodyKeys":["totals","requestedTime","orderType","restaurantId","status","customer","notes","items","externalOrderId","orderTime","payment","orderId"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '2a81fb73-a009-4d42-9d23-5d5b1de2c63e',\n  'ORD-20251104055206-005',\n  'EXT-COFFEE-005',\n  'NYC-CAFE-001',\n  'd7c317a5-6af6-4256-9906-0dc053880853',\n  'Emma Wilson',\n  '555-0505',\n  'emma.w@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:52:06Z',\n  '2025-11-04T06:07:06Z',\n  10.73,\n  0.86,\n  1.5,\n  0,\n  0,\n  13.09,\n  'mobile_payment',\n  'completed',\n  'TXN-8362',\n  13.09,\n  'Name: Emma',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:06"}
{"body":{"customer":{"email":"emma.w@example.com","name":"Emma Wilson","phone":"555-0505"},"externalOrderId":"EXT-COFFEE-005","items":[{"itemId":"COFFEE-001","modifiers":[{"name":"Extra Shot","price":0.75},{"name":"Oat Milk","price":0.5}],"name":"Large Latte","quantity":1,"totalPrice":5.49,"unitPrice":5.49},{"itemId":"PASTRY-001","name":"Blueberry Muffin","quantity":1,"totalPrice":3.99,"unitPrice":3.99}],"notes":"Name: Emma","orderId":"ORD-20251104055206-005","orderTime":"2025-11-04T05:52:06Z","orderType":"pickup","payment":{"amount":13.09,"method":"mobile_payment","status":"completed","transactionId":"TXN-8362"},"requestedTime":"2025-11-04T06:07:06Z","restaurantId":"NYC-CAFE-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":10.73,"tax":0.86,"tip":1.5,"total":13.09}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '2a81fb73-a009-4d42-9d23-5d5b1de2c63e',\n  'ORD-20251104055206-005',\n  'EXT-COFFEE-005',\n  'NYC-CAFE-001',\n  'd7c317a5-6af6-4256-9906-0dc053880853',\n  'Emma Wilson',\n  '555-0505',\n  'emma.w@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:52:06Z',\n  '2025-11-04T06:07:06Z',\n  10.73,\n  0.86,\n  1.5,\n  0,\n  0,\n  13.09,\n  'mobile_payment',\n  'completed',\n  'TXN-8362',\n  13.09,\n  'Name: Emma',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:52:06","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"EXT-PICKUP-001","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":2,"orderId":"ORD-20251104055308-001","totalAmount":18.88},"service":"pos-order-gateway-api","serviceProcessingTime":"16ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b63afbc8-bc48-4bd4-9279-2d583fc16c32',\n  'ORD-20251104055308-001',\n  'EXT-PICKUP-001',\n  'NYC-DELI-001',\n  '3c14dce9-b35c-4f05-9f4d-0c3fa61282ca',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:53:08Z',\n  '2025-11-04T06:23:08Z',\n  17.48,\n  1.4,\n  0,\n  0,\n  0,\n  18.88,\n  'credit_card',\n  'completed',\n  'TXN-7578',\n  18.88,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:08"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"23ms","requestAnalysis":{"bodyKeys":["totals","requestedTime","orderType","restaurantId","status","customer","notes","items","externalOrderId","orderTime","payment","orderId"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b63afbc8-bc48-4bd4-9279-2d583fc16c32',\n  'ORD-20251104055308-001',\n  'EXT-PICKUP-001',\n  'NYC-DELI-001',\n  '3c14dce9-b35c-4f05-9f4d-0c3fa61282ca',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:53:08Z',\n  '2025-11-04T06:23:08Z',\n  17.48,\n  1.4,\n  0,\n  0,\n  0,\n  18.88,\n  'credit_card',\n  'completed',\n  'TXN-7578',\n  18.88,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:08"}
{"body":{"customer":{"email":"john.smith@example.com","name":"John Smith","phone":"555-0101"},"externalOrderId":"EXT-PICKUP-001","items":[{"itemId":"SANDWICH-001","modifiers":[{"name":"Extra Cheese","price":1.5}],"name":"Turkey Club Sandwich","quantity":1,"specialInstructions":"No mayo, extra lettuce","totalPrice":12.99,"unitPrice":12.99},{"itemId":"DRINK-001","name":"Iced Tea","quantity":1,"totalPrice":2.99,"unitPrice":2.99}],"notes":"Please call when ready","orderId":"ORD-20251104055308-001","orderTime":"2025-11-04T05:53:08Z","orderType":"pickup","payment":{"amount":18.88,"method":"credit_card","status":"completed","transactionId":"TXN-7578"},"requestedTime":"2025-11-04T06:23:08Z","restaurantId":"NYC-DELI-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":17.48,"tax":1.4,"tip":0,"total":18.88}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'b63afbc8-bc48-4bd4-9279-2d583fc16c32',\n  'ORD-20251104055308-001',\n  'EXT-PICKUP-001',\n  'NYC-DELI-001',\n  '3c14dce9-b35c-4f05-9f4d-0c3fa61282ca',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:53:08Z',\n  '2025-11-04T06:23:08Z',\n  17.48,\n  1.4,\n  0,\n  0,\n  0,\n  18.88,\n  'credit_card',\n  'completed',\n  'TXN-7578',\n  18.88,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:08","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"EXT-DINEIN-003","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":3,"orderId":"ORD-20251104055309-003","totalAmount":36.82},"service":"pos-order-gateway-api","serviceProcessingTime":"11ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '83cb2f6c-4e93-4456-aead-2805958d8525',\n  'ORD-20251104055309-003',\n  'EXT-DINEIN-003',\n  'NYC-BURGER-001',\n  '1cd0f17d-6061-404f-b119-be9ef6c8c884',\n  'Michael Chen',\n  '555-0303',\n  'mchen@example.com',\n  null,\n  'dine-in',\n  '2025-11-04T05:53:09Z',\n  null,\n  29.46,\n  2.36,\n  5,\n  0,\n  0,\n  36.82,\n  'credit_card',\n  'completed',\n  'TXN-4944',\n  36.82,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:09"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"27ms","requestAnalysis":{"bodyKeys":["totals","orderType","restaurantId","status","customer","notes","items","externalOrderId","orderTime","payment","orderId"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '83cb2f6c-4e93-4456-aead-2805958d8525',\n  'ORD-20251104055309-003',\n  'EXT-DINEIN-003',\n  'NYC-BURGER-001',\n  '1cd0f17d-6061-404f-b119-be9ef6c8c884',\n  'Michael Chen',\n  '555-0303',\n  'mchen@example.com',\n  null,\n  'dine-in',\n  '2025-11-04T05:53:09Z',\n  null,\n  29.46,\n  2.36,\n  5,\n  0,\n  0,\n  36.82,\n  'credit_card',\n  'completed',\n  'TXN-4944',\n  36.82,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:09"}
{"body":{"customer":{"email":"mchen@example.com","name":"Michael Chen","phone":"555-0303"},"externalOrderId":"EXT-DINEIN-003","items":[{"itemId":"BURGER-001","modifiers":[{"name":"Extra Bacon","price":2},{"name":"Avocado","price":1.5}],"name":"Classic Cheeseburger","quantity":1,"specialInstructions":"Medium rare, no onions","totalPrice":14.99,"unitPrice":14.99},{"itemId":"SIDES-001","name":"French Fries","quantity":1,"totalPrice":4.99,"unitPrice":4.99},{"itemId":"SHAKE-001","name":"Chocolate Milkshake","quantity":1,"totalPrice":5.99,"unitPrice":5.99}],"notes":"Table 15","orderId":"ORD-20251104055309-003","orderTime":"2025-11-04T05:53:09Z","orderType":"dine-in","payment":{"amount":36.82,"method":"credit_card","status":"completed","transactionId":"TXN-4944"},"restaurantId":"NYC-BURGER-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":29.46,"tax":2.36,"tip":5,"total":36.82}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '83cb2f6c-4e93-4456-aead-2805958d8525',\n  'ORD-20251104055309-003',\n  'EXT-DINEIN-003',\n  'NYC-BURGER-001',\n  '1cd0f17d-6061-404f-b119-be9ef6c8c884',\n  'Michael Chen',\n  '555-0303',\n  'mchen@example.com',\n  null,\n  'dine-in',\n  '2025-11-04T05:53:09Z',\n  null,\n  29.46,\n  2.36,\n  5,\n  0,\n  0,\n  36.82,\n  'credit_card',\n  'completed',\n  'TXN-4944',\n  36.82,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:09","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"EXT-COFFEE-005","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":2,"orderId":"ORD-20251104055310-005","totalAmount":13.09},"service":"pos-order-gateway-api","serviceProcessingTime":"7ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'c68efea7-5acb-499c-82ef-24a9bd114a29',\n  'ORD-20251104055310-005',\n  'EXT-COFFEE-005',\n  'NYC-CAFE-001',\n  '61336910-d7f0-43ef-81c7-d0448fafdcc0',\n  'Emma Wilson',\n  '555-0505',\n  'emma.w@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:53:10Z',\n  '2025-11-04T06:08:10Z',\n  10.73,\n  0.86,\n  1.5,\n  0,\n  0,\n  13.09,\n  'mobile_payment',\n  'completed',\n  'TXN-9054',\n  13.09,\n  'Name: Emma',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:10"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"23ms","requestAnalysis":{"bodyKeys":["totals","requestedTime","orderType","restaurantId","status","customer","notes","items","externalOrderId","orderTime","payment","orderId"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'c68efea7-5acb-499c-82ef-24a9bd114a29',\n  'ORD-20251104055310-005',\n  'EXT-COFFEE-005',\n  'NYC-CAFE-001',\n  '61336910-d7f0-43ef-81c7-d0448fafdcc0',\n  'Emma Wilson',\n  '555-0505',\n  'emma.w@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:53:10Z',\n  '2025-11-04T06:08:10Z',\n  10.73,\n  0.86,\n  1.5,\n  0,\n  0,\n  13.09,\n  'mobile_payment',\n  'completed',\n  'TXN-9054',\n  13.09,\n  'Name: Emma',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:10"}
{"body":{"customer":{"email":"emma.w@example.com","name":"Emma Wilson","phone":"555-0505"},"externalOrderId":"EXT-COFFEE-005","items":[{"itemId":"COFFEE-001","modifiers":[{"name":"Extra Shot","price":0.75},{"name":"Oat Milk","price":0.5}],"name":"Large Latte","quantity":1,"totalPrice":5.49,"unitPrice":5.49},{"itemId":"PASTRY-001","name":"Blueberry Muffin","quantity":1,"totalPrice":3.99,"unitPrice":3.99}],"notes":"Name: Emma","orderId":"ORD-20251104055310-005","orderTime":"2025-11-04T05:53:10Z","orderType":"pickup","payment":{"amount":13.09,"method":"mobile_payment","status":"completed","transactionId":"TXN-9054"},"requestedTime":"2025-11-04T06:08:10Z","restaurantId":"NYC-CAFE-001","status":"received","totals":{"deliveryFee":0,"discount":0,"subtotal":10.73,"tax":0.86,"tip":1.5,"total":13.09}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'c68efea7-5acb-499c-82ef-24a9bd114a29',\n  'ORD-20251104055310-005',\n  'EXT-COFFEE-005',\n  'NYC-CAFE-001',\n  '61336910-d7f0-43ef-81c7-d0448fafdcc0',\n  'Emma Wilson',\n  '555-0505',\n  'emma.w@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:53:10Z',\n  '2025-11-04T06:08:10Z',\n  10.73,\n  0.86,\n  1.5,\n  0,\n  0,\n  13.09,\n  'mobile_payment',\n  'completed',\n  'TXN-9054',\n  13.09,\n  'Name: Emma',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:53:10","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"ORD-20251104055529-001","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":2,"orderId":"ORD-20251104055529-001","totalAmount":17.26},"service":"pos-order-gateway-api","serviceProcessingTime":"9ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '47a94419-ffc1-44ed-913a-de41d5498ca8',\n  'ORD-20251104055529-001',\n  'ORD-20251104055529-001',\n  'NYC-DELI-001',\n  'beb2e1b1-0368-4688-9e0b-3683a0dec341',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:55:29.211Z',\n  null,\n  15.98,\n  1.28,\n  0,\n  0,\n  0,\n  17.26,\n  'credit_card',\n  'completed',\n  null,\n  0,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:29"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"16ms","requestAnalysis":{"bodyKeys":["orderId","payment","totals","customer","orderType","items","notes"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '47a94419-ffc1-44ed-913a-de41d5498ca8',\n  'ORD-20251104055529-001',\n  'ORD-20251104055529-001',\n  'NYC-DELI-001',\n  'beb2e1b1-0368-4688-9e0b-3683a0dec341',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:55:29.211Z',\n  null,\n  15.98,\n  1.28,\n  0,\n  0,\n  0,\n  17.26,\n  'credit_card',\n  'completed',\n  null,\n  0,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:29"}
{"body":{"customer":{"email":"john.smith@example.com","name":"John Smith","phone":"555-0101"},"items":[{"name":"Turkey Club Sandwich","quantity":1,"totalPrice":12.99,"unitPrice":12.99},{"name":"Iced Tea","quantity":1,"totalPrice":2.99,"unitPrice":2.99}],"notes":"Please call when ready","orderId":"ORD-20251104055529-001","orderType":"pickup","payment":{"method":"credit_card","status":"completed"},"totals":{"subtotal":15.98,"tax":1.28,"total":17.26}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '47a94419-ffc1-44ed-913a-de41d5498ca8',\n  'ORD-20251104055529-001',\n  'ORD-20251104055529-001',\n  'NYC-DELI-001',\n  'beb2e1b1-0368-4688-9e0b-3683a0dec341',\n  'John Smith',\n  '555-0101',\n  'john.smith@example.com',\n  null,\n  'pickup',\n  '2025-11-04T05:55:29.211Z',\n  null,\n  15.98,\n  1.28,\n  0,\n  0,\n  0,\n  17.26,\n  'credit_card',\n  'completed',\n  null,\n  0,\n  'Please call when ready',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:29","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"ORD-20251104055529-003","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":3,"orderId":"ORD-20251104055529-003","totalAmount":33.05},"service":"pos-order-gateway-api","serviceProcessingTime":"16ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '5633d26a-8f47-4335-82fe-5a737418f2a0',\n  'ORD-20251104055529-003',\n  'ORD-20251104055529-003',\n  'NYC-DELI-001',\n  '3c252f83-2b6d-400b-a875-4f92adcf775e',\n  'Michael Chen',\n  '555-0303',\n  null,\n  null,\n  'dine-in',\n  '2025-11-04T05:55:29.966Z',\n  null,\n  25.97,\n  2.08,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'completed',\n  null,\n  0,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:29"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"31ms","requestAnalysis":{"bodyKeys":["orderId","payment","totals","customer","orderType","items","notes"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '5633d26a-8f47-4335-82fe-5a737418f2a0',\n  'ORD-20251104055529-003',\n  'ORD-20251104055529-003',\n  'NYC-DELI-001',\n  '3c252f83-2b6d-400b-a875-4f92adcf775e',\n  'Michael Chen',\n  '555-0303',\n  null,\n  null,\n  'dine-in',\n  '2025-11-04T05:55:29.966Z',\n  null,\n  25.97,\n  2.08,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'completed',\n  null,\n  0,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:29"}
{"body":{"customer":{"name":"Michael Chen","phone":"555-0303"},"items":[{"name":"Classic Cheeseburger","quantity":1,"totalPrice":14.99,"unitPrice":14.99},{"name":"French Fries","quantity":1,"totalPrice":4.99,"unitPrice":4.99},{"name":"Chocolate Milkshake","quantity":1,"totalPrice":5.99,"unitPrice":5.99}],"notes":"Table 15","orderId":"ORD-20251104055529-003","orderType":"dine-in","payment":{"method":"credit_card","status":"completed"},"totals":{"subtotal":25.97,"tax":2.08,"tip":5,"total":33.05}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  '5633d26a-8f47-4335-82fe-5a737418f2a0',\n  'ORD-20251104055529-003',\n  'ORD-20251104055529-003',\n  'NYC-DELI-001',\n  '3c252f83-2b6d-400b-a875-4f92adcf775e',\n  'Michael Chen',\n  '555-0303',\n  null,\n  null,\n  'dine-in',\n  '2025-11-04T05:55:29.966Z',\n  null,\n  25.97,\n  2.08,\n  5,\n  0,\n  0,\n  33.05,\n  'credit_card',\n  'completed',\n  null,\n  0,\n  'Table 15',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:29","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
{"databaseState":{"errorCode":"SQLITE_CONSTRAINT","errorErrno":19,"lastQuery":"Check logs for last executed query"},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":4,"level":"error","message":"‚ùå SERVICE CREATION FAILED - Detailed Debug","orderDataSnapshot":{"externalOrderId":"ORD-20251104055530-005","hasCustomer":true,"hasItems":true,"hasTotals":true,"itemCount":2,"orderId":"ORD-20251104055530-005","totalAmount":11.74},"service":"pos-order-gateway-api","serviceProcessingTime":"21ms","sqliteError":"SQLITE_CONSTRAINT","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'c58ac83c-c59e-472e-8194-a5a5de0e6013',\n  'ORD-20251104055530-005',\n  'ORD-20251104055530-005',\n  'NYC-DELI-001',\n  '4daeb867-6ac9-45f0-81f9-f9f8fd063564',\n  'Emma Wilson',\n  '555-0505',\n  null,\n  null,\n  'pickup',\n  '2025-11-04T05:55:30.129Z',\n  null,\n  9.48,\n  0.76,\n  1.5,\n  0,\n  0,\n  11.74,\n  'mobile_payment',\n  'completed',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:30"}
{"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","failedAtStep":6,"level":"error","message":"‚ùå ORDER CREATION FAILED - Detailed Debug","processedOrderSnapshot":"Transformation completed","processingTime":"66ms","requestAnalysis":{"bodyKeys":["orderId","payment","totals","customer","orderType","items"],"contentType":"application/json","hasBody":true,"method":"POST","url":"/","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"},"service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'c58ac83c-c59e-472e-8194-a5a5de0e6013',\n  'ORD-20251104055530-005',\n  'ORD-20251104055530-005',\n  'NYC-DELI-001',\n  '4daeb867-6ac9-45f0-81f9-f9f8fd063564',\n  'Emma Wilson',\n  '555-0505',\n  null,\n  null,\n  'pickup',\n  '2025-11-04T05:55:30.129Z',\n  null,\n  9.48,\n  0.76,\n  1.5,\n  0,\n  0,\n  11.74,\n  'mobile_payment',\n  'completed',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:30"}
{"body":{"customer":{"name":"Emma Wilson","phone":"555-0505"},"items":[{"name":"Large Latte","quantity":1,"totalPrice":5.49,"unitPrice":5.49},{"name":"Blueberry Muffin","quantity":1,"totalPrice":3.99,"unitPrice":3.99}],"orderId":"ORD-20251104055530-005","orderType":"pickup","payment":{"method":"mobile_payment","status":"completed"},"totals":{"subtotal":9.48,"tax":0.76,"tip":1.5,"total":11.74}},"error":"SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')","ip":"::ffff:127.0.0.1","level":"error","message":"API Error:","method":"POST","path":"/api/v1/orders","service":"pos-order-gateway-api","stack":"Error: SQLITE_CONSTRAINT: CHECK constraint failed: payment_status IN ('pending', 'authorized', 'captured', 'failed')\n--> in Statement#run([\n  'c58ac83c-c59e-472e-8194-a5a5de0e6013',\n  'ORD-20251104055530-005',\n  'ORD-20251104055530-005',\n  'NYC-DELI-001',\n  '4daeb867-6ac9-45f0-81f9-f9f8fd063564',\n  'Emma Wilson',\n  '555-0505',\n  null,\n  null,\n  'pickup',\n  '2025-11-04T05:55:30.129Z',\n  null,\n  9.48,\n  0.76,\n  1.5,\n  0,\n  0,\n  11.74,\n  'mobile_payment',\n  'completed',\n  null,\n  0,\n  '',\n  'received',\n  'api',\n  null,\n  null,\n  null\n], [Function (anonymous)])\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:76:19)\n    at Database.<anonymous> (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\node_modules\\sqlite3\\lib\\sqlite3.js:20:19)\n    at C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:27:8\n    at new Promise (<anonymous>)\n    at Object.run (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\config\\database-sqlite.js:26:10)\n    at OrderService.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\services\\orderService.js:184:42)\n    at async OrderController.createOrder (C:\\Users\\James\\Documents\\Workspace\\OrderGatewayAPI\\src\\controllers\\orderController.js:305:21)","timestamp":"2025-11-04 05:55:30","userAgent":"Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22000.65"}
